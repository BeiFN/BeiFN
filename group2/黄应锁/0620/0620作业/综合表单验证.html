<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        *{
            margin:0;
            padding:0;
        }
        form{
            width:400px;
            background: pink;
            margin: 0 auto;
            text-align: center
        }
        span{margin-right: 40px;}
        .c1{  margin-right: 10px;}
        input{
            background: #ccc;
            border-radius: 5px;
            border: 0;
        }
        .weak,.middle,.strong{
            display: inline-block;
            width: 57px;
            line-height: 15px;
            font-size: 10px;
            height: 15px;
            margin: 0;
            
        }
        #box1,#box2,#box3{
            font-size: 8px;
            color:red;
            visibility: hidden;
        }
        #check{display: inline-block;background: #ccc}
    </style>
</head>
<body>
    <form action="">
        <fieldset>
            <legend>账户详情资料</legend>
            <span>用户名称</span><input id="username" type="text"><br>
            <div id="box1">我</div>
            <span>登录密码</span><input type="password" id="pwd"><br>
            <div id="box2">我</div>
            <span class="c1">重复登录密码</span><input type="password" id="again"><br>
            <div id="box3">我</div>
            <span class="c1"> 密码安全级别</span >
                <div id = "check">
                   <span class="weak"></span><span class="middle"></span><span class="strong"></span> 
                </div><br>
                <button> 注册</button>
                
        </fieldset>
    </form>
        
    <script>
        username.onblur = function(){
            var getName = document.getElementById("username").value;
            for(var i = 0 , letter; letter = getName[i++];){
                var ascii = letter.charCodeAt(0);
                // console.log(ascii);
                if(ascii<48 || ascii > 57 && ascii <65 ||ascii >90 && ascii <97 ||ascii > 122){
                    box1.style.visibility = "visible";
                    box1.innerHTML = "用户名含有非法字符"
                    return false;
                }
            }
            if(getName.length<6 && getName.length>= 1 ||getName.length>20){
                    box1.style.visibility = "visible";
                    box1.innerHTML = "用户名长度应在6-20位之间"
                    return false;
            }

        }
        username.onfocus = function(){
            box1.style.visibility = "hidden";
            username.select();
        }
        var password = document.getElementById("pwd").value;
        pwd.onblur = function(){
            var password = document.getElementById("pwd").value;
            if(password.length < 6 && password.length >= 1|| password.length > 20){
                    box2.style.visibility = "visible";
                    box2.innerHTML = "密码长度应在6-20位之间";
                    return false;
            }
            var count = num(password);
            console.log(count);
            if(count===1){
                var weak = document.querySelector(".weak");
                weak.style.backgroundColor = "red";
                weak.innerHTML = "弱";
            }
            if(count===2){
                var middle = document.querySelector(".middle");
                middle.style.backgroundColor = "yellow";
                middle.innerHTML = "中";
            }
            if(count===3){
                var strong = document.querySelector(".strong");
                strong.style.backgroundColor = "green";
                strong.innerHTML = "强";
            }
        }
        pwd.onfocus = function(){
            box2.style.visibility = "hidden";
            pwd.select();
            var ele_span = document.getElementById("check").children;
            for( var i = 0 ;i < ele_span.length;i++){
                ele_span[i].style ="";
                ele_span[i].innerHTML ="";
            }

        }
        again.onblur = function(){
            var password = document.getElementById("pwd").value;
            var again_p = document.getElementById("again").value;
            if(password !== again_p){
                box3.style.visibility = "visible";
                box3.innerHTML = "两次输入密码不一致"
                return false;
            }
        }
        again.onfocus = function(){
            box3.style.visibility = "hidden";
            again.select();
        }
        
    
        function num(password){
            var res = {
                    num : false,
                    letter :false,
                    other: false,
                }
            for(var i = 0 ,letter;letter = password[i++];){
                var ascii = letter.charCodeAt(0);
               
                if(ascii>= 48 &&ascii<=57 && !res.num){
                    res.num = true;
                }else if(ascii>= 65 && ascii<=90 && !res.letter || ascii>= 97 && ascii<=122 && !res.letter){
                    res.letter = true;
                }else if(ascii>57  && ascii<65 && !res.other ||ascii>90  && ascii<97 && !res.other||ascii>122 && !res.other||ascii<47 && !res.other){
                    res.other = true;    
                }
            }
            var count=0;
            for(var k in res){
                res[k] ? count++ :""; 
            }
            return count;
        }
    </script>
</body>
</html>