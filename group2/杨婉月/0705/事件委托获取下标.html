<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        .btns{
            height:100px;
            width:400px;
            background:#ccc;
        }
        .btn{
            height:100%;
            width:100px;
            float:left;
            margin-right:20px;
            background: bisque;
        }
    </style>
</head>
<body>
    <div class="btns">
        <div class="btn"></div>
        <div class="btn"></div>
        <div class="btn"></div>
    </div>
    <script>
        function Test(){
            this.btn = document.querySelectorAll(".btn");
            this.btns = document.querySelector(".btns");
            this.init();
        }
        Test.prototype.init = function(){
            this.btns.addEventListener("click", delegation(this.del.bind(this), ".btn"));
        }
        //???? ele哪来的？？？没有传参啊
        Test.prototype.del = function(e, ele){
            // console.log(ele);
            // let res;
            // Array.from(this.btn).forEach(function(ee, index){
            //     if(ele == ee){
            //         res = index;
            //     }
            // }.bind(this))
            // console.log(res);

            Array.from(this.btn).forEach(function(ee, index){
                ee.index = index;
            })
            console.log(ele.index);

        }

        //事件委托
        function delegation( handlerClick , selector ){
            return function(evt){
                var e = evt || window.event;
                var target = e.target || e.srcElement;
                var eleList = this.querySelectorAll(selector);
                var targetFamily = [];
                var _tempTarget = target;
                var count = 0;
                while(true && count ++ < 100){
                        if(_tempTarget === this || _tempTarget === null){
                            break;
                        }
                        targetFamily.push(_tempTarget);
                        _tempTarget = _tempTarget.parentNode;
                }
                for(var i = 0 , ele ; ele = eleList[i++]; ){
                        if(targetFamily.length === 1 ? ele === targetFamily[0] : targetFamily.indexOf(ele) !== -1){
                            handlerClick.call(ele , e , ele);
                            break;
                        }
                }
            }
        }

        new Test();
    </script>
</body>
</html>