<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600587 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <meta name="content-class" content="yinxiang.markdown"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="625"/>

<div><span><div style="font-size: 14px; margin: 0; padding: 0; width: 100%;"><h5 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 16px; color: #333;">什么叫做事件委托:</h5>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">我们把原本绑定(监听)给多个元素的事件，监听给这些元素的父级。<br/>
在触发阶段验证事件源的身份，来辨别事件触发是否合法。<br/>
常规的事件绑定会导致大量冗余事件; 我们解决这样问题的时候通常会使用事件的委托</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">多次绑定事件时使用事件委托 , 防止事件冗余;
动态生成元素的事件绑定
</code></pre>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">基础方法</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">var ul = document.querySelector(&quot;ul&quot;);
ul.addEventListener(&quot;click&quot;,function(evt){
// console.log(&quot;hello&quot;);
// 做一个判断;
// 当前发生事件的事件源，是不是我们想要绑定事件的元素;
var e = evt || window.event;
var target = e.target || e.srcElement;
// 要求 , 事件源是 li;
if(target.nodeName === &quot;LI&quot;){
console.log(&quot;hello world&quot;);
// target即为当前发生事件的元素;
target.style.background = &quot;yellowgreen&quot;;
}
</code></pre>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;"> var ul = document.querySelector(&quot;ul&quot;);
ul.addEventListener(&quot;click&quot;, function(evt){
// 1. 判定
 var e = evt || event;
var target = e.target || e.srcElement;
 if(target.nodeName === &quot;LI&quot;){
// 执行事件处理函数;
 // 2. 事件处理函数;
 handlerClick();
}
})
 function handlerClick(){
console.log(&quot;hello i'm handlerClick&quot;);
 }
</code></pre>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">事件绑定时不太好传递参数;<br/>
解决 ,函数内部返回一个函数不就可以了么;<br/>
delegation =&gt; 整合两个函数 ; 1. 匿名函数; 2. 事件处理函数(handlerClick);<br/>
事件执行的时候 匿名函数会执行;<br/>
匿名函数的作用 判定是不是应该调用 handlerCLick</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">var ul = document.querySelector(&quot;ul&quot;);
ul.addEventListener(&quot;click&quot;,delegation(handlerClick,&quot;LI&quot;))
function delegation(handlerClick , selector ){
return function(evt){
// console.log(this); // 永久指向ul
var e = evt || window.event;
var target = e.target || e.srcElement;
// console.log(&quot;匿名函数&quot;,target);
if(target.nodeName === selector){
handlerClick.call(target,e);
}
}
}
</code></pre>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">优化 ：</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">var ul = document.querySelector(&quot;ul&quot;);
ul.addEventListener(&quot;click&quot;,delegation(handlerClick,&quot;.lilili&quot;))
function delegation(handlerClick , selector ){
return function(evt){
var eleList = this.querySelectorAll(selector);
// console.log(eleList);
var e = evt || window.event;
var target = e.target || e.srcElement;
var targetFamily = [];
var _temp = target;
var count = 0;
while(true &amp;&amp; count++ &lt; 100){
if(_temp === this){
break;
}
targetFamily.push(_temp)
_temp = _temp.parentNode
}
// console.log(targetFamily ,target) ;
// 判定target是不是在这个数组之中;
for(var i = 0 , ele ; ele = eleList[i++]; ){
if( targetFamily.length === 1 ? (target === ele) : (targetFamily.indexOf(ele) !== -1) ){
handlerClick.call(ele,e);
break;
}
}
}
}
function handlerClick(e){
// console.log(&quot;事件执行&quot;,this,e);
this.style.background = &quot;yellowgreen&quot;;
}
</code></pre>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">优化   封装 ：</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">var ul = document.querySelector(&quot;ul&quot;);
var foo = null
ul.addEventListener(&quot;click&quot; , delegation(handlerClick , &quot;.lilili&quot;))
function delegation( handlerClick , selector ){
return function(evt){
var e = evt || window.event;
var target = e.target || e.srcElement;
var eleList = this.querySelectorAll(selector);
// console.log(target);
var targetFamily = [];
var _tempTarget = target;
var count = 0
while(true &amp;&amp; count ++ &lt; 100){
if(_tempTarget === this){
break;
}
targetFamily.push(_tempTarget);
_tempTarget = _tempTarget.parentNode;
}
// console.log(targetFamily);
// ele 就是符合规定的元素;
for(var i = 0 , ele ; ele = eleList[i++]; ){
// 如果冒泡数组之中存在一个元素，直接比对,如果存在多个元素,挨个比对;
if(targetFamily.length === 1 ? ele === 
targetFamily[0] : targetFamily.indexOf(ele) !== -1){
handlerClick.call(ele , e);// 性能 考虑
break;
}
}
}
}
function handlerClick(){
this.style.background = &quot;yellowgreen&quot;;
}
</code></pre>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">布局：</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">&lt;style&gt;
li{
list-style-type: none;
}
*{
margin: 0;
padding: 0;
}
li{
padding: 3px 5px;
border-bottom: 2px solid #ddd;
text-align: center;
width: 80%;
margin: 5px auto;
background: #fff;
}
ul{
background: #ddd;
}
&lt;/style&gt;
&lt;body&gt;

&lt;ul&gt;
&lt;li &gt;&lt;span&gt;这 &lt;i&gt;是&lt;/i&gt; 一个带有事件的li&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span&gt;这是一个带有事件的li&lt;/span&gt;&lt;/li&gt;
&lt;li &gt;这是一个带有事件的li&lt;/li&gt;
&lt;li &gt;这是一个带有事件的li&lt;/li&gt;
&lt;li &gt;这是一个带有事件的li&lt;/li&gt;
&lt;li &gt;这是一个带有事件的li&lt;/li&gt;
&lt;li &gt;这是一个带有事件的li&lt;/li&gt;
&lt;li &gt;这是一个带有事件的li&lt;/li&gt;
&lt;li &gt;这是一个带有事件的li&lt;/li&gt;
&lt;li &gt;这是一个带有事件的li&lt;/li&gt;
&lt;li&gt;这是一个带有事件的li&lt;/li&gt;
&lt;li&gt;这是一个带有事件的li&lt;/li&gt;
&lt;li&gt;这是一个带有事件的li&lt;/li&gt;
&lt;li&gt;这是一个带有事件的li&lt;/li&gt;
&lt;li&gt;这是一个带有事件的li&lt;/li&gt;
&lt;li&gt;这是一个带有事件的li&lt;/li&gt;
&lt;li&gt;这是一个带有事件的li&lt;/li&gt;
&lt;li&gt;这是一个带有事件的li&lt;/li&gt;
&lt;li&gt;这是一个带有事件的li&lt;/li&gt;
&lt;li&gt;这是一个带有事件的li&lt;/li&gt;
&lt;li&gt;这是一个带有事件的li&lt;/li&gt;
&lt;li&gt;这是一个带有事件的li&lt;/li&gt;
&lt;/ul&gt;
</code></pre>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">封装的事件on
</code></pre>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">function on (dom,eventType,callback){
if(dom.addEventListener){
dom.addEventListener(eventType,callback);
}else if (dom.attachEvent){
dom.attachEvent(&quot;on&quot; + eventType,callback)
}
else{
dom[&quot;on&quot; + eventType] = callback;
}
}
on(dom,eventType,callback);
</code></pre>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">function on(dom,evetType,callback,selector){
if(dom.addEventListener){
if(arguments.length === 4 &amp;&amp; typeof arguments[3] === &quot;string&quot; ){
dom.addEventListener(evetType , delegation( callback , selector ));
}else{
dom.addEventListener(evetType , callback);
}
}else if(dom.attachEvent){
dom.attachEvent(&quot;on&quot; + eventType, callback);
}else{
dom[&quot;on&quot; + eventType] = callback;
}
}
function delegation( handlerClick , selector ){
return function(evt){
var e = evt || window.event;
var target = e.target || e.srcElement;
var eleList = this.querySelectorAll(selector);
var targetFamily = [];
var _tempTarget = target;
var count = 0;
while(true &amp;&amp; count ++ &lt; 100){
if(_tempTarget === this || _tempTarget === null){
break;
}
targetFamily.push(_tempTarget);
_tempTarget = _tempTarget.parentNode;
}
for(var i = 0 , ele ; ele = eleList[i++]; ){
if(targetFamily.length === 1 ? ele === targetFamily[0] : 
targetFamily.indexOf(ele) !== -1){
handlerClick.call(ele , e);
break;
}
}
}
}

</code></pre>
</div><center style="display:none !important;visibility:collapse !important;height:0 !important;white-space:nowrap;width:100%;overflow:hidden">%0A%23%23%23%23%23%20%E4%BB%80%E4%B9%88%E5%8F%AB%E5%81%9A%E4%BA%8B%E4%BB%B6%E5%A7%94%E6%89%98%3A%0A%E6%88%91%E4%BB%AC%E6%8A%8A%E5%8E%9F%E6%9C%AC%E7%BB%91%E5%AE%9A(%E7%9B%91%E5%90%AC)%E7%BB%99%E5%A4%9A%E4%B8%AA%E5%85%83%E7%B4%A0%E7%9A%84%E4%BA%8B%E4%BB%B6%EF%BC%8C%E7%9B%91%E5%90%AC%E7%BB%99%E8%BF%99%E4%BA%9B%E5%85%83%E7%B4%A0%E7%9A%84%E7%88%B6%E7%BA%A7%E3%80%82%0A%E5%9C%A8%E8%A7%A6%E5%8F%91%E9%98%B6%E6%AE%B5%E9%AA%8C%E8%AF%81%E4%BA%8B%E4%BB%B6%E6%BA%90%E7%9A%84%E8%BA%AB%E4%BB%BD%EF%BC%8C%E6%9D%A5%E8%BE%A8%E5%88%AB%E4%BA%8B%E4%BB%B6%E8%A7%A6%E5%8F%91%E6%98%AF%E5%90%A6%E5%90%88%E6%B3%95%E3%80%82%0A%E5%B8%B8%E8%A7%84%E7%9A%84%E4%BA%8B%E4%BB%B6%E7%BB%91%E5%AE%9A%E4%BC%9A%E5%AF%BC%E8%87%B4%E5%A4%A7%E9%87%8F%E5%86%97%E4%BD%99%E4%BA%8B%E4%BB%B6%3B%20%E6%88%91%E4%BB%AC%E8%A7%A3%E5%86%B3%E8%BF%99%E6%A0%B7%E9%97%AE%E9%A2%98%E7%9A%84%E6%97%B6%E5%80%99%E9%80%9A%E5%B8%B8%E4%BC%9A%E4%BD%BF%E7%94%A8%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%A7%94%E6%89%98%0A%0A%20%20%20%20%E5%A4%9A%E6%AC%A1%E7%BB%91%E5%AE%9A%E4%BA%8B%E4%BB%B6%E6%97%B6%E4%BD%BF%E7%94%A8%E4%BA%8B%E4%BB%B6%E5%A7%94%E6%89%98%20%2C%20%E9%98%B2%E6%AD%A2%E4%BA%8B%E4%BB%B6%E5%86%97%E4%BD%99%3B%0A%20%20%20%20%E5%8A%A8%E6%80%81%E7%94%9F%E6%88%90%E5%85%83%E7%B4%A0%E7%9A%84%E4%BA%8B%E4%BB%B6%E7%BB%91%E5%AE%9A%0A%E5%9F%BA%E7%A1%80%E6%96%B9%E6%B3%95%0A%60%60%60%0Avar%20ul%20%3D%20document.querySelector(%22ul%22)%3B%0Aul.addEventListener(%22click%22%2Cfunction(evt)%7B%0A%2F%2F%20console.log(%22hello%22)%3B%0A%2F%2F%20%E5%81%9A%E4%B8%80%E4%B8%AA%E5%88%A4%E6%96%AD%3B%0A%2F%2F%20%E5%BD%93%E5%89%8D%E5%8F%91%E7%94%9F%E4%BA%8B%E4%BB%B6%E7%9A%84%E4%BA%8B%E4%BB%B6%E6%BA%90%EF%BC%8C%E6%98%AF%E4%B8%8D%E6%98%AF%E6%88%91%E4%BB%AC%E6%83%B3%E8%A6%81%E7%BB%91%E5%AE%9A%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%85%83%E7%B4%A0%3B%0Avar%20e%20%3D%20evt%20%7C%7C%20window.event%3B%0Avar%20target%20%3D%20e.target%20%7C%7C%20e.srcElement%3B%0A%2F%2F%20%E8%A6%81%E6%B1%82%20%2C%20%E4%BA%8B%E4%BB%B6%E6%BA%90%E6%98%AF%20li%3B%0Aif(target.nodeName%20%3D%3D%3D%20%22LI%22)%7B%0Aconsole.log(%22hello%20world%22)%3B%0A%2F%2F%20target%E5%8D%B3%E4%B8%BA%E5%BD%93%E5%89%8D%E5%8F%91%E7%94%9F%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%85%83%E7%B4%A0%3B%0Atarget.style.background%20%3D%20%22yellowgreen%22%3B%0A%7D%0A%60%60%60%0A%60%60%60%0A%20var%20ul%20%3D%20document.querySelector(%22ul%22)%3B%0Aul.addEventListener(%22click%22%2C%20function(evt)%7B%0A%2F%2F%201.%20%E5%88%A4%E5%AE%9A%0A%20var%20e%20%3D%20evt%20%7C%7C%20event%3B%0Avar%20target%20%3D%20e.target%20%7C%7C%20e.srcElement%3B%0A%20if(target.nodeName%20%3D%3D%3D%20%22LI%22)%7B%0A%2F%2F%20%E6%89%A7%E8%A1%8C%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0%3B%0A%20%2F%2F%202.%20%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0%3B%0A%20handlerClick()%3B%0A%7D%0A%7D)%0A%20function%20handlerClick()%7B%0Aconsole.log(%22hello%20i'm%20handlerClick%22)%3B%0A%20%7D%0A%60%60%60%0A%E4%BA%8B%E4%BB%B6%E7%BB%91%E5%AE%9A%E6%97%B6%E4%B8%8D%E5%A4%AA%E5%A5%BD%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0%3B%0A%E8%A7%A3%E5%86%B3%20%2C%E5%87%BD%E6%95%B0%E5%86%85%E9%83%A8%E8%BF%94%E5%9B%9E%E4%B8%80%E4%B8%AA%E5%87%BD%E6%95%B0%E4%B8%8D%E5%B0%B1%E5%8F%AF%E4%BB%A5%E4%BA%86%E4%B9%88%3B%0A%20delegation%20%3D%3E%20%E6%95%B4%E5%90%88%E4%B8%A4%E4%B8%AA%E5%87%BD%E6%95%B0%20%3B%201.%20%E5%8C%BF%E5%90%8D%E5%87%BD%E6%95%B0%3B%202.%20%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0(handlerClick)%3B%0A%E4%BA%8B%E4%BB%B6%E6%89%A7%E8%A1%8C%E7%9A%84%E6%97%B6%E5%80%99%20%E5%8C%BF%E5%90%8D%E5%87%BD%E6%95%B0%E4%BC%9A%E6%89%A7%E8%A1%8C%3B%0A%E5%8C%BF%E5%90%8D%E5%87%BD%E6%95%B0%E7%9A%84%E4%BD%9C%E7%94%A8%20%E5%88%A4%E5%AE%9A%E6%98%AF%E4%B8%8D%E6%98%AF%E5%BA%94%E8%AF%A5%E8%B0%83%E7%94%A8%20handlerCLick%0A%60%60%60%0Avar%20ul%20%3D%20document.querySelector(%22ul%22)%3B%0Aul.addEventListener(%22click%22%2Cdelegation(handlerClick%2C%22LI%22))%0Afunction%20delegation(handlerClick%20%2C%20selector%20)%7B%0Areturn%20function(evt)%7B%0A%2F%2F%20console.log(this)%3B%20%2F%2F%20%E6%B0%B8%E4%B9%85%E6%8C%87%E5%90%91ul%0Avar%20e%20%3D%20evt%20%7C%7C%20window.event%3B%0Avar%20target%20%3D%20e.target%20%7C%7C%20e.srcElement%3B%0A%2F%2F%20console.log(%22%E5%8C%BF%E5%90%8D%E5%87%BD%E6%95%B0%22%2Ctarget)%3B%0Aif(target.nodeName%20%3D%3D%3D%20selector)%7B%0AhandlerClick.call(target%2Ce)%3B%0A%7D%0A%7D%0A%7D%0A%60%60%60%0A%E4%BC%98%E5%8C%96%20%EF%BC%9A%20%0A%60%60%60%0Avar%20ul%20%3D%20document.querySelector(%22ul%22)%3B%0Aul.addEventListener(%22click%22%2Cdelegation(handlerClick%2C%22.lilili%22))%0Afunction%20delegation(handlerClick%20%2C%20selector%20)%7B%0Areturn%20function(evt)%7B%0Avar%20eleList%20%3D%20this.querySelectorAll(selector)%3B%0A%2F%2F%20console.log(eleList)%3B%0Avar%20e%20%3D%20evt%20%7C%7C%20window.event%3B%0Avar%20target%20%3D%20e.target%20%7C%7C%20e.srcElement%3B%0Avar%20targetFamily%20%3D%20%5B%5D%3B%0Avar%20_temp%20%3D%20target%3B%0Avar%20count%20%3D%200%3B%0Awhile(true%20%26%26%20count%2B%2B%20%3C%20100)%7B%0Aif(_temp%20%3D%3D%3D%20this)%7B%0Abreak%3B%0A%7D%0AtargetFamily.push(_temp)%0A_temp%20%3D%20_temp.parentNode%0A%7D%0A%2F%2F%20console.log(targetFamily%20%2Ctarget)%20%3B%0A%2F%2F%20%E5%88%A4%E5%AE%9Atarget%E6%98%AF%E4%B8%8D%E6%98%AF%E5%9C%A8%E8%BF%99%E4%B8%AA%E6%95%B0%E7%BB%84%E4%B9%8B%E4%B8%AD%3B%0Afor(var%20i%20%3D%200%20%2C%20ele%20%3B%20ele%20%3D%20eleList%5Bi%2B%2B%5D%3B%20)%7B%0Aif(%20targetFamily.length%20%3D%3D%3D%201%20%3F%20(target%20%3D%3D%3D%20ele)%20%3A%20(targetFamily.indexOf(ele)%20!%3D%3D%20-1)%20)%7B%0AhandlerClick.call(ele%2Ce)%3B%0Abreak%3B%0A%7D%0A%7D%0A%7D%0A%7D%0Afunction%20handlerClick(e)%7B%0A%2F%2F%20console.log(%22%E4%BA%8B%E4%BB%B6%E6%89%A7%E8%A1%8C%22%2Cthis%2Ce)%3B%0Athis.style.background%20%3D%20%22yellowgreen%22%3B%0A%7D%0A%60%60%60%0A%E4%BC%98%E5%8C%96%20%20%20%E5%B0%81%E8%A3%85%20%EF%BC%9A%0A%60%60%60%0Avar%20ul%20%3D%20document.querySelector(%22ul%22)%3B%0Avar%20foo%20%3D%20null%0Aul.addEventListener(%22click%22%20%2C%20delegation(handlerClick%20%2C%20%22.lilili%22))%0Afunction%20delegation(%20handlerClick%20%2C%20selector%20)%7B%0Areturn%20function(evt)%7B%0Avar%20e%20%3D%20evt%20%7C%7C%20window.event%3B%0Avar%20target%20%3D%20e.target%20%7C%7C%20e.srcElement%3B%0Avar%20eleList%20%3D%20this.querySelectorAll(selector)%3B%0A%2F%2F%20console.log(target)%3B%0Avar%20targetFamily%20%3D%20%5B%5D%3B%0Avar%20_tempTarget%20%3D%20target%3B%0Avar%20count%20%3D%200%0Awhile(true%20%26%26%20count%20%2B%2B%20%3C%20100)%7B%0Aif(_tempTarget%20%3D%3D%3D%20this)%7B%0Abreak%3B%0A%7D%0AtargetFamily.push(_tempTarget)%3B%0A_tempTarget%20%3D%20_tempTarget.parentNode%3B%0A%7D%0A%2F%2F%20console.log(targetFamily)%3B%0A%2F%2F%20ele%20%E5%B0%B1%E6%98%AF%E7%AC%A6%E5%90%88%E8%A7%84%E5%AE%9A%E7%9A%84%E5%85%83%E7%B4%A0%3B%0Afor(var%20i%20%3D%200%20%2C%20ele%20%3B%20ele%20%3D%20eleList%5Bi%2B%2B%5D%3B%20)%7B%0A%2F%2F%20%E5%A6%82%E6%9E%9C%E5%86%92%E6%B3%A1%E6%95%B0%E7%BB%84%E4%B9%8B%E4%B8%AD%E5%AD%98%E5%9C%A8%E4%B8%80%E4%B8%AA%E5%85%83%E7%B4%A0%EF%BC%8C%E7%9B%B4%E6%8E%A5%E6%AF%94%E5%AF%B9%2C%E5%A6%82%E6%9E%9C%E5%AD%98%E5%9C%A8%E5%A4%9A%E4%B8%AA%E5%85%83%E7%B4%A0%2C%E6%8C%A8%E4%B8%AA%E6%AF%94%E5%AF%B9%3B%0Aif(targetFamily.length%20%3D%3D%3D%201%20%3F%20ele%20%3D%3D%3D%20%0AtargetFamily%5B0%5D%20%3A%20targetFamily.indexOf(ele)%20!%3D%3D%20-1)%7B%0AhandlerClick.call(ele%20%2C%20e)%3B%2F%2F%20%E6%80%A7%E8%83%BD%20%E8%80%83%E8%99%91%0Abreak%3B%0A%7D%0A%7D%0A%7D%0A%7D%0Afunction%20handlerClick()%7B%0Athis.style.background%20%3D%20%22yellowgreen%22%3B%0A%7D%0A%60%60%60%0A%E5%B8%83%E5%B1%80%EF%BC%9A%0A%60%60%60%0A%3Cstyle%3E%0Ali%7B%0Alist-style-type%3A%20none%3B%0A%7D%0A*%7B%0Amargin%3A%200%3B%0Apadding%3A%200%3B%0A%7D%0Ali%7B%0Apadding%3A%203px%205px%3B%0Aborder-bottom%3A%202px%20solid%20%23ddd%3B%0Atext-align%3A%20center%3B%0Awidth%3A%2080%25%3B%0Amargin%3A%205px%20auto%3B%0Abackground%3A%20%23fff%3B%0A%7D%0Aul%7B%0Abackground%3A%20%23ddd%3B%0A%7D%0A%3C%2Fstyle%3E%0A%3Cbody%3E%0A%0A%3Cul%3E%0A%3Cli%20class%3D%22lilili%22%3E%3Cspan%3E%E8%BF%99%20%3Ci%3E%E6%98%AF%3C%2Fi%3E%20%E4%B8%80%E4%B8%AA%E5%B8%A6%E6%9C%89%E4%BA%8B%E4%BB%B6%E7%9A%84li%3C%2Fspan%3E%3C%2Fli%3E%0A%3Cli%3E%3Cspan%3E%E8%BF%99%E6%98%AF%E4%B8%80%E4%B8%AA%E5%B8%A6%E6%9C%89%E4%BA%8B%E4%BB%B6%E7%9A%84li%3C%2Fspan%3E%3C%2Fli%3E%0A%3Cli%20class%3D%22lilili%22%3E%E8%BF%99%E6%98%AF%E4%B8%80%E4%B8%AA%E5%B8%A6%E6%9C%89%E4%BA%8B%E4%BB%B6%E7%9A%84li%3C%2Fli%3E%0A%3Cli%20class%3D%22lilili%22%3E%E8%BF%99%E6%98%AF%E4%B8%80%E4%B8%AA%E5%B8%A6%E6%9C%89%E4%BA%8B%E4%BB%B6%E7%9A%84li%3C%2Fli%3E%0A%3Cli%20class%3D%22lilili%22%3E%E8%BF%99%E6%98%AF%E4%B8%80%E4%B8%AA%E5%B8%A6%E6%9C%89%E4%BA%8B%E4%BB%B6%E7%9A%84li%3C%2Fli%3E%0A%3Cli%20class%3D%22lilili%22%3E%E8%BF%99%E6%98%AF%E4%B8%80%E4%B8%AA%E5%B8%A6%E6%9C%89%E4%BA%8B%E4%BB%B6%E7%9A%84li%3C%2Fli%3E%0A%3Cli%20class%3D%22lilili%22%3E%E8%BF%99%E6%98%AF%E4%B8%80%E4%B8%AA%E5%B8%A6%E6%9C%89%E4%BA%8B%E4%BB%B6%E7%9A%84li%3C%2Fli%3E%0A%3Cli%20class%3D%22lilili%22%3E%E8%BF%99%E6%98%AF%E4%B8%80%E4%B8%AA%E5%B8%A6%E6%9C%89%E4%BA%8B%E4%BB%B6%E7%9A%84li%3C%2Fli%3E%0A%3Cli%20class%3D%22lilili%22%3E%E8%BF%99%E6%98%AF%E4%B8%80%E4%B8%AA%E5%B8%A6%E6%9C%89%E4%BA%8B%E4%BB%B6%E7%9A%84li%3C%2Fli%3E%0A%3Cli%20class%3D%22lilili%22%3E%E8%BF%99%E6%98%AF%E4%B8%80%E4%B8%AA%E5%B8%A6%E6%9C%89%E4%BA%8B%E4%BB%B6%E7%9A%84li%3C%2Fli%3E%0A%3Cli%3E%E8%BF%99%E6%98%AF%E4%B8%80%E4%B8%AA%E5%B8%A6%E6%9C%89%E4%BA%8B%E4%BB%B6%E7%9A%84li%3C%2Fli%3E%0A%3Cli%3E%E8%BF%99%E6%98%AF%E4%B8%80%E4%B8%AA%E5%B8%A6%E6%9C%89%E4%BA%8B%E4%BB%B6%E7%9A%84li%3C%2Fli%3E%0A%3Cli%3E%E8%BF%99%E6%98%AF%E4%B8%80%E4%B8%AA%E5%B8%A6%E6%9C%89%E4%BA%8B%E4%BB%B6%E7%9A%84li%3C%2Fli%3E%0A%3Cli%3E%E8%BF%99%E6%98%AF%E4%B8%80%E4%B8%AA%E5%B8%A6%E6%9C%89%E4%BA%8B%E4%BB%B6%E7%9A%84li%3C%2Fli%3E%0A%3Cli%3E%E8%BF%99%E6%98%AF%E4%B8%80%E4%B8%AA%E5%B8%A6%E6%9C%89%E4%BA%8B%E4%BB%B6%E7%9A%84li%3C%2Fli%3E%0A%3Cli%3E%E8%BF%99%E6%98%AF%E4%B8%80%E4%B8%AA%E5%B8%A6%E6%9C%89%E4%BA%8B%E4%BB%B6%E7%9A%84li%3C%2Fli%3E%0A%3Cli%3E%E8%BF%99%E6%98%AF%E4%B8%80%E4%B8%AA%E5%B8%A6%E6%9C%89%E4%BA%8B%E4%BB%B6%E7%9A%84li%3C%2Fli%3E%0A%3Cli%3E%E8%BF%99%E6%98%AF%E4%B8%80%E4%B8%AA%E5%B8%A6%E6%9C%89%E4%BA%8B%E4%BB%B6%E7%9A%84li%3C%2Fli%3E%0A%3Cli%3E%E8%BF%99%E6%98%AF%E4%B8%80%E4%B8%AA%E5%B8%A6%E6%9C%89%E4%BA%8B%E4%BB%B6%E7%9A%84li%3C%2Fli%3E%0A%3Cli%3E%E8%BF%99%E6%98%AF%E4%B8%80%E4%B8%AA%E5%B8%A6%E6%9C%89%E4%BA%8B%E4%BB%B6%E7%9A%84li%3C%2Fli%3E%0A%3Cli%3E%E8%BF%99%E6%98%AF%E4%B8%80%E4%B8%AA%E5%B8%A6%E6%9C%89%E4%BA%8B%E4%BB%B6%E7%9A%84li%3C%2Fli%3E%0A%3Cli%3E%E8%BF%99%E6%98%AF%E4%B8%80%E4%B8%AA%E5%B8%A6%E6%9C%89%E4%BA%8B%E4%BB%B6%E7%9A%84li%3C%2Fli%3E%0A%3C%2Ful%3E%0A%60%60%60%0A%0A%20%20%20%20%E5%B0%81%E8%A3%85%E7%9A%84%E4%BA%8B%E4%BB%B6on%0A%60%60%60%0Afunction%20on%20(dom%2CeventType%2Ccallback)%7B%0Aif(dom.addEventListener)%7B%0Adom.addEventListener(eventType%2Ccallback)%3B%0A%7Delse%20if%20(dom.attachEvent)%7B%0Adom.attachEvent(%22on%22%20%2B%20eventType%2Ccallback)%0A%7D%0Aelse%7B%0Adom%5B%22on%22%20%2B%20eventType%5D%20%3D%20callback%3B%0A%7D%0A%7D%0Aon(dom%2CeventType%2Ccallback)%3B%0A%60%60%60%0A%60%60%60%0Afunction%20on(dom%2CevetType%2Ccallback%2Cselector)%7B%0Aif(dom.addEventListener)%7B%0Aif(arguments.length%20%3D%3D%3D%204%20%26%26%20typeof%20arguments%5B3%5D%20%3D%3D%3D%20%22string%22%20)%7B%0Adom.addEventListener(evetType%20%2C%20delegation(%20callback%20%2C%20selector%20))%3B%0A%7Delse%7B%0Adom.addEventListener(evetType%20%2C%20callback)%3B%0A%7D%0A%7Delse%20if(dom.attachEvent)%7B%0Adom.attachEvent(%22on%22%20%2B%20eventType%2C%20callback)%3B%0A%7Delse%7B%0Adom%5B%22on%22%20%2B%20eventType%5D%20%3D%20callback%3B%0A%7D%0A%7D%0Afunction%20delegation(%20handlerClick%20%2C%20selector%20)%7B%0Areturn%20function(evt)%7B%0Avar%20e%20%3D%20evt%20%7C%7C%20window.event%3B%0Avar%20target%20%3D%20e.target%20%7C%7C%20e.srcElement%3B%0Avar%20eleList%20%3D%20this.querySelectorAll(selector)%3B%0Avar%20targetFamily%20%3D%20%5B%5D%3B%0Avar%20_tempTarget%20%3D%20target%3B%0Avar%20count%20%3D%200%3B%0Awhile(true%20%26%26%20count%20%2B%2B%20%3C%20100)%7B%0Aif(_tempTarget%20%3D%3D%3D%20this%20%7C%7C%20_tempTarget%20%3D%3D%3D%20null)%7B%0Abreak%3B%0A%7D%0AtargetFamily.push(_tempTarget)%3B%0A_tempTarget%20%3D%20_tempTarget.parentNode%3B%0A%7D%0Afor(var%20i%20%3D%200%20%2C%20ele%20%3B%20ele%20%3D%20eleList%5Bi%2B%2B%5D%3B%20)%7B%0Aif(targetFamily.length%20%3D%3D%3D%201%20%3F%20ele%20%3D%3D%3D%20targetFamily%5B0%5D%20%3A%20%0AtargetFamily.indexOf(ele)%20!%3D%3D%20-1)%7B%0AhandlerClick.call(ele%20%2C%20e)%3B%0Abreak%3B%0A%7D%0A%7D%0A%7D%0A%7D%0A%0A%60%60%60%0A</center></span>
</div></body></html> 