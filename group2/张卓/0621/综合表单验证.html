<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>综合表单验证</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        li {
            list-style: none
        }

        #bigbox {
            width: 800px;
            height: 800px;
            background: #404040;
            margin: 30px auto;
            position: relative;
        }

        .tip {
            color: gold;
            font-size: 14px;
            margin: 0 0 0 20px
        }

        span,
        .tip>span {
            color: red;
            vertical-align: middle
        }

        .xxTitle {
            clear: both;
            font-size: 20px;
            color: rgb(14, 118, 187);
            margin: 20px 0 20px 70px
        }

        input {
            border-radius: 5px;
            width: 250px;
            vertical-align: middle;
            background: gray;
            color: black;
            border: 1px solid gray;
            height: 1.5em;
        }

        input::placeholder {
            color: white
        }

        #self>ul,
        #xiangxi>ul {
            margin-left: 120px;
            line-height: 2em;
        }

        #self>ul>li,
        #xiangxi>ul>li {
            display: inline-block;
            width: 180px;
            vertical-align: middle;
            color: gainsboro
        }

        #level {
            vertical-align: middle;
            display: inline-block;
            width: 201px;
            overflow: hidden;
            height: 20px;
            background: white;
        }

        #level li {
            float: left;
            font-size: 14px;
            width: 66px;
            border-right: 1px solid gainsboro;
            height: 20px;
            line-height: 20px;
            text-align: center;
        }

        #level li span {
            color: white;
        }

        #zhuce {
            margin: 50px auto;
            width: 300px;
            text-align: center;
        }

        #zhuce li {
            margin-right: 30px;
            cursor: pointer;
            background: rgb(14, 117, 185);
            border-radius: 5px;
            border: 1px;
            display: inline-block;
            width: 80px;
            height: 40px;
            text-align: center;
            line-height: 40px;
            font-size: 16px;
            color: gainsboro;
        }

        #zhuce input {
            width: 20px;
        }

        #tankuang {
            text-align: center;
            position: relative;
        }

        #tankuang span {
            background: #e9e5c0;
            height: 25px;
            border-radius: 5px;
            position: absolute
        }
        #ipt_yanzhengma{
            width: 80px;
        }
        #yanzhengcode #generateCode{
            width: 80px;
            background: white;
            height: 20px;   
            margin-left: 10px;
            font-size: 14px; 
            text-align: center;
            line-height: 20px;
            cursor: pointer;
        }
        #generateCode span{
            color: black;
            height: 20px;
        }
    </style>
</head>

<body>
    <div id="bigbox">
        <span class="tip">注意<span> * </span>为必填项</span>
        <div id="tankuang"><span></span></div>
        <ul id="xiangxi">
            <li class="xxTitle">账户详细资料</li>
            <ul id="username">
                <li>用户名称</li>
                <span>*</span>
                <input type="text" id="ipt_username" placeholder="请输入用户名 字母+数字" />
            </ul>
            <ul id="password">
                <li>登陆密码</li>
                <span>*</span>
                <input id="ipt_password" type="password" placeholder="请输入密码">
            </ul>
            <ul id="repwd">
                <li>重复登陆密码</li>
                <span>*</span>
                <input id="ipt_repwd" type="password" placeholder="请再次输入密码">
            </ul>
            <ul id="safeLevel">
                <li>密码安全级别</li>
                <span>*</span>
                <ul id="level">
                    <li class="ruo"><span>弱</span></li>
                    <li class="zhong"><span>中</span></li>
                    <li class="qiang"><span>强</span></li>
                </ul>
            </ul>
        </ul>
        <ul id="self">
            <li class="xxTitle">个人信息资料</li>
            <ul id="email">
                <li>电子邮件</li>
                <span>*</span>
                <input id="ipt_email" type="text" placeholder="请输入您的电子邮箱">
            </ul>
            <ul id="trueName">
                <li>真实姓名</li>
                <span>*</span>
                <input type="text"  id="ipt_trueName"  placeholder="请输入您的真实姓名">
            </ul>
            <ul id="tel">
                <li>中奖通知手机</li>
                <span>*</span>
                <input id="ipt_tel" type="text">
            </ul>
            <ul id="yanzhengcode">
                <li>验证码</li>
                <span>*</span>
                <input id="ipt_yanzhengma" type="text" class="yzcode">
                <li id="generateCode"><span></span></li>
            </ul>
        </ul>
        <ul id="zhuce">
            <li>注册</li>
            <input type="checkbox"><span>10天内免登录</span>
        </ul>
    </div>

    <script>
        var tk = document.getElementById("tankuang").children
        //获取用户名并判断
        var username = document.getElementById("ipt_username")
        username.onblur = function () {
            var txt_username = username.value;
            // console.log(txt_username)
            var res = charAndNum(txt_username);
            if (!res) {
                tk[0].innerHTML = "用户名格式不正确"
            }
        }
        ipt_username.onfocus =noTan;
            
        //获取密码并判断强度
        var password = document.getElementById("ipt_password");
        password.onkeyup = function () {
            var txt_password = password.value;
            var res = pwdStrong(txt_password)
            var id_level = document.getElementById("level").children;
            if (res == 0) {
                id_level[0].style.backgroundColor = "white";
                id_level[1].style.backgroundColor = "white";
                id_level[2].style.backgroundColor = "white";
            }
            if (res == 1) {
                id_level[0].style.backgroundColor = "green";
                id_level[1].style.backgroundColor = "white";
                id_level[2].style.backgroundColor = "white";
            }
            if (res == 2) {
                id_level[0].style.backgroundColor = "white";
                id_level[1].style.backgroundColor = "green";
                id_level[2].style.backgroundColor = "white";
            }
            if (res == 3) {
                id_level[0].style.backgroundColor = "white";
                id_level[1].style.backgroundColor = "white";
                id_level[2].style.backgroundColor = "green";
            }
        }
        
        //获取两次密码并判断
        var repwd = document.getElementById("ipt_repwd")
        repwd.onblur=function(){
            var txt_repwd = repwd.value;
            var txt_pwd = password.value;
            var res = checkPass(txt_pwd,txt_repwd)
            if(!res){
                tk[0].innerHTML = "两次密码输入不一致"
            }
        }
        repwd.onfocus=noTan;

        //获取电子邮箱并判断
        var email = document.getElementById("ipt_email")
        email.onblur = function(){
            var txt_email = email.value;
            var res = checkEmail(txt_email)
            if(!res){
                tk[0].innerHTML = "邮箱格式不正确"
            }
        }
        email.onfocus=noTan

        // 判断真实姓名
        var tname = document.getElementById("ipt_trueName")
        tname.onblur = function(){
            var txt_name = tname.value
            var res = checkTrueName(txt_name)
            if(!res){
                tk[0].innerHTML = "姓名输入不正确"
            }
        }
        tname.onfocus=noTan


        //判断手机号
        var tel = document.getElementById("ipt_tel");
        tel.onblur = function(){
            var txt_tel = tel.value
            var res = checkTel(txt_tel)
            if(!res){
                tk[0].innerHTML = "手机号格式不正确"
            }
        }
        tel.onfocus = noTan

        //生成验证码
        var gcode = document.getElementById("generateCode")
        var ipt_code = document.getElementById("ipt_yanzhengma")
        window.onload=function(){
            var ma = generateCode()
            gcode.children[0].innerHTML = ma
        }
        

        //点击注册比对验证码
        var zc = document.getElementById("zhuce")
        zc.onclick = function(){
            var txt_code = ipt_code.value;
            var res = checkCode(txt_code,gcode.children[0].innerHTML);
            // console.log(res)
            if(!res){
                tk[0].innerHTML = "验证码输入错误"
            }
        }
        ipt_code.onfocus = noTan

        //点击后再次生成验证码
        gcode.onclick=function(){
            var ma = generateCode()
            gcode.children[0].innerHTML = ma
        }

// ----------------------------下面是函数区----------------------------------------
        //名称是字母+数字函数 
        function charAndNum(str) {
            var flag = true; //格式正确
            for (var i in str) {
                //这里的i是脚标
                var k = str[i].charCodeAt(0)
                if (!(k >= 48 && k <= 57 || k >= 65 && k <= 90 || k >= 97 && k <= 122)) {
                    flag = false; //格式不正确
                }
            }
            return flag;
        }

        //判断密码强度函数
        function pwdStrong(str) {
            //           数字     字母   特殊字符
            var flag = [false, false, false]

            for (var i in str) {
                var asc = str[i].charCodeAt(0);
                //判断是否有数字
                if (asc >= 48 && asc <= 57 && (flag[0]!=true)) {
                    flag[0] = true;
                }
                //有字母
                if (asc >= 65 && asc <= 90 || asc >= 97 && asc <= 122 && (flag[1]!=true)) {
                    flag[1] = true;
                }
                //有特殊字符
                if (!(asc >= 48 && asc <= 57 || asc >= 65 && asc <= 90 || asc >= 97 && asc <= 122)) {
                    flag[2] = true;
                }
            }
            //返回数组
            var res = 0;
            //如果为
            if (flag[0]==true || flag[1]==true) {
                res = 1;
            }
            if (flag[0]==true && flag[1]==true) {
                res = 2
            }
            if (flag[2]==true) {
                res = 3;
            }
            return res;
        }


        //判断两次的密码是否一致函数
        function checkPass(str1, str2) {
            if (Number(str1) == Number(str2)) {
                return true
            } else {
                return false;
            }
        }

        //判断纯数字函数 手机也是纯数字 验证码
        function onlyNum(str) {
            var flag = true;
            for (var i in str) {
                var k = i.charCodeAt(0)
                if (!(k >= 48 && k <= 57)) {
                    flag = false;
                }
            }
            return flag;
        }
        //判断电子邮箱函数
        function checkEmail(str) {
            var flag = false;
            for (var i in str) {
                //@符号要在后几位出现
                var asc = str[i].charCodeAt(0)
                if (asc == 64 && i > 6) {
                    //判断符号前面是不是纯数字
                    var flag2 = true
                    for (var j = 0; j < i; j++) {
                        var a = str[j].charCodeAt(0)
                        if (!(a >= 48 && a <= 57)) {
                            var flag2 = false;
                        }
                    }
                    //如果进来了就return flag2
                    return flag2;
                }
            }
            //如果没进来就return flag
            return flag;
        }

        //检查真实姓名函数
        function checkTrueName(str) {
            var flag = false
            //姓名的长度大于二
            if (str.length >= 2) {
                var flag2 = true;
                //检查每一个字符的字符编码是否为中文
                for (var i in str) {
                    var k = str[i].charCodeAt(0)
                    if (!(k >= 19968 && k <= 40869)) {
                        flag2 = false;
                    }
                }
                return flag2;
            }
            return flag;
        }

        //检查手机号函数
        function checkTel(str) {
            var flag = false
            //手机号为11位
            if (str.length == 11) {
                var flag2 = true;
                for (var i in str) {
                    if (!(str[i] >= 0 && str[i] <= 9)) {
                        flag2 = false;
                    }
                }
                return flag2;
            }
            return flag;
        }

        //生成验证码函数
        function generateCode() {
            var code = parseInt(Math.random() * 9000 + 1000)//[1000-10000)
            return code;
        }

        //检测验证码函数
        function checkCode(str, code) {
            if (Number(str) == Number(code)) {
                return true;
            } else {
                return false;
            }
        }

        //提示框消失函数
        function noTan(){
            tk[0].innerHTML = ""
        }


    </script>

</body>

</html>