<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>延时二级菜单</title>
    <style>
        *{
            padding:0;
            margin:0;
        }
        li{
            list-style: none;
        }
        #nav{
            width:100%;
            height: 50px;
            text-align: center;
            line-height: 50px;
        }
        #nav>li{
            width:20%;
            float: left;
            height: 50px;
            background: #ddd;
        }
        .nav_li{
            position: relative;
        }
        .nav_two{
            width: 200px;
            height: 250px;
            background: pink;
            position: absolute;
            left: 20%;
            top:65px;
            display: none;
            border-radius:5px;
        }
        .nav_two>li{
            width:100%;
            float: left;
        }
    </style>
</head>
<body>
    <ul id="nav">
        <li class="nav_li">
            一级菜单
            <ul class="nav_two">
                <li>二级菜单</li>
                <li>二级菜单</li>
                <li>二级菜单</li>
                <li>二级菜单</li>
                <li>二级菜单</li>
            </ul>
        </li>
        <li class="nav_li">
            一级菜单
            <ul class="nav_two">
                <li>二级菜单</li>
                <li>二级菜单</li>
                <li>二级菜单</li>
                <li>二级菜单</li>
                <li>二级菜单</li>
            </ul>
        </li>
        <li class="nav_li">
            一级菜单
            <ul class="nav_two">
                <li>二级菜单</li>
                <li>二级菜单</li>
                <li>二级菜单</li>
                <li>二级菜单</li>
                <li>二级菜单</li>
            </ul>
        </li>
        <li class="nav_li">
            一级菜单
            <ul class="nav_two">
                <li>二级菜单</li>
                <li>二级菜单</li>
                <li>二级菜单</li>
                <li>二级菜单</li>
                <li>二级菜单</li>
            </ul>
        </li>
        <li class="nav_li">
            一级菜单
            <ul class="nav_two">
                <li>二级菜单</li>
                <li>二级菜单</li>
                <li>二级菜单</li>
                <li>二级菜单</li>
                <li>二级菜单</li>
            </ul>
        </li>
    </ul>
    <script>
        // var nav_li  = document.querySelectorAll("#nav")[0];
        // var nav_two = document.querySelectorAll(".nav_two")[0];
        // var timer   = null;             //定义一个timer
        // //移入一级菜单时，显示二级菜单
        // function showNav(){
        //     nav_two.style.display = "block";
        // }
        // //移出一级菜单时，延时 0.5s 隐藏二级菜单
        // function hiddenNav(){
        //     clearTimeout(timer)                     //每次移出时，清空上一个延时器
        //     timer = setTimeout(function(){
        //         nav_two.style.display = "none";
        //     },500);        
        // }
        // //移入二级菜单时，显示二级菜单，并清除延时器
        // function clearTimer(){
        //     clearTimeout(timer);
        //     nav_two.style.display = "block";
        // }
        // nav_li.addEventListener("mouseover",showNav);
        // nav_li.addEventListener("mouseout",hiddenNav);
        // nav_two.addEventListener("mouseover",clearTimer);
        function setMenu(){
            var nav_li  = document.querySelectorAll(".nav_li");
            var nav_two = document.querySelectorAll(".nav_two");
            var timer   = null;                                     //定义一个timer,清除定时器
            for(var i = 0; i < nav_li.length ; i++ ){            
                nav_li[i].setAttribute("data-id",i);                //给每一个一级菜单设置一个data-id属性
                nav_li[i].onmouseover = function(){                 //移入一级菜单时，显示二级菜单
                    for(var j = 0; j<nav_two.length ; j++ ){
                        nav_two[j].setAttribute("data-index",j);    //给每一个二级菜单设置一个data-index属性
                    }
                    var temp = this.getAttribute("data-id");
                    nav_two[temp].style.display="block";
                    this.style.background="rgba(0,0,0,0.2)"
                }
                nav_li[i].onmouseout = function(){                  //移出当前一级菜单时，隐藏当前二级菜单
                    clearTimeout(timer);
                    var temp = this.getAttribute("data-id");
                    timer = setTimeout(function(){
                        nav_two[temp].style.display="none";
                    },50);
                    nav_li[temp].style.background="#ddd"
                }
                nav_two[i].onmouseover = function(){                //移入当前二级菜单时，显示当前二级菜单
                    clearTimeout(timer);
                    var temp = this.getAttribute("data-index");
                    nav_two[temp].style.display="block";
                }
                nav_two[i].onmouseout = function(){                 //移出当前二级菜单时，隐藏当前二级菜单
                    clearTimeout(timer);
                    var temp = this.getAttribute("data-index");
                    nav_two[temp].style.display="none";
                }    
            }
        }
        setMenu();
    </script>
</body>
</html>