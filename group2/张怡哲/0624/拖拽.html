<!DOCTYPE html>
<html lang="en">
<head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta http-equiv="X-UA-Compatible" content="ie=edge">
      <title>Document</title>
      <style>
      
            *{
                  margin:0;
                  padding: 0;
            }
            #box{
                  width: 300px;
                  height: 200px;
                  background: yellowgreen;
                  color: #fff;
                  box-shadow: 0 0 5px yellowgreen;
                  border-radius: 10px;
                  overflow: hidden;
                  position: absolute;
                  text-align: center;
            }
            #top-bar{
                  width: 300px;
                  height: 40px;
                  text-align: center;
                  line-height: 40px;
                  background: rgba(0,0,0,.3);
            }
            #goBack{
                  padding: 3px 5px ;
                  background: #fff;
                  box-shadow: 0 0 5px #30f;
                  border: none;
            }
      </style>
</head>
<body>
      <div id="box">
            <div id="top-bar">
                  拖拽条 
            </div>
            <button id="goBack">回放</button>
      </div>
      <script>
            // 1. 鼠标按下;   拖拽开始;
            // 2. 鼠标移动;   拖拽进行中;
            // 3. 鼠标抬起;   拖拽结束;
            var box = document.getElementById("box");
            var topBar = document.getElementById("top-bar");
            var goReplay = document.getElementById("goBack");
            var fun = null;
            var recordArray = [];

            function handlerDragStart(evt){
                var e = evt || event;

                document.removeEventListener("mousemove" , fun);
                document.addEventListener("mousemove" , fun = handlerDragMove.bind(false,{offsetX:e.offsetX,offsetY:e.offsetY}));
            }

            function handlerDragMove(offset,evt){
                var e = evt || event;

                numLeft = e.clientX - offset.offsetX;
                numTop = e.clientY - offset.offsetY;


                box.style.left = numLeft + "px";
                box.style.top = numTop + "px";
                // for (var key in recordArray){
                //     console.log(recordArray[key]);
                // }
                
                recordArray.push({
                    left : numLeft,
                    top  : numTop
                })
            }

            function handlerDragEnd(){
                document.removeEventListener("mousemove" , fun);
            }

            function handlerReplay(){
                var start = recordArray.length;
                timer = setInterval(function(){
                    start --;
                    box.style.left = recordArray[start].left + "px";
                    box.style.top  = recordArray[start].top + "px";
                    if(start === 0 ){
                        clearInterval(timer);
                        recordArray.length = 0;
                    }
                },10);
            }

            topBar.addEventListener("mousedown" , handlerDragStart);
            topBar.addEventListener("mouseup" , handlerDragEnd);
            goReplay.addEventListener("click" , handlerReplay);
      </script>
</body>
</html>