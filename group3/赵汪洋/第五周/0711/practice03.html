<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>跨域-服务器代理</title>
</head>

<body>
    <script src="public.js"></script>
    <script>
        let {myPromiseAjax} = Public;
        let url = "http://localhost/dt?kw=%E7%9F%AD%E5%8F%91&type=feed&include_fields=top_comments%2Cis_root%2Csource_link%2Citem%2Cbuyable%2Croot_id%2Cstatus%2Clike_count%2Clike_id%2Csender%2Calbum%2Creply_count%2Cfavorite_blog_id&_type=&start=24&_=1562848835519";
        myPromiseAjax(url).then(res => {
            console.log(JSON.parse(res));
        });
    

        // function practice(type) {
        //     // console.log(type === "GET");
        //     for (let attr in type) {
        //         console.log(type[attr]);
        //         console.log(attr);
        //     }
        // }

        // practice({});


        // function myPromiseAjax(url, type, data) {
        //     let xhr = null;
        //     if (window.XMLHttpRequest) xhr = new XMLHttpRequest();
        //     else if (window.ActiveXObject) xhr = new ActiveXObject("Microsoft.XMLHTTP");
        //     else throw "浏览器不支持ajax";
        //     console.log(xhr);
        // }

        // myPromiseAjax();


        // console.log({a:1,b:2}.length);


        //     function ajax(url  , data, type){
        //         return new Promise( function(resolve , reject){
        //               var xhr = null;
        //               if(XMLHttpRequest){
        //                     xhr = new XMLHttpRequest();
        //               }else{
        //                     xhr = new ActiveXObject("Mricosoft.XMLHTTP");
        //               }
        //               if(xhr === null) throw "浏览器不支持ajax";

        //               var dataStr = "";
        //               for(var attr in data){
        //                     dataStr += (dataStr.length > 0 ? "&" : "") + attr + "=" + data[attr];
        //               }

        //               type === "GET" ? url += (/\?/.test(url) ? "&" : "?") + dataStr : "";

        //               xhr.open( type ? type : "GET" , url );
        //               type === "POST" ? xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded"): "";
        //               xhr.send( type === "POST" ? dataStr : null );
        //               xhr.onreadystatechange = function(){
        //                     if(xhr.readyState === 4 && xhr.status === 200){
        //                           resolve(xhr.responseText);
        //                           console.log(url);
        //                     }
        //               }

        //               // 设置超时;
        //               setTimeout(function(){
        //                     reject(xhr,"timeout");
        //               },8000)
        //         })
        //   }

        //   ajax("04jsonp.php", {a:1, b:2})
    </script>
</body>

</html>