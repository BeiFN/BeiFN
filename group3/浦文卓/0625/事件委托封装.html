<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>事件委托封装</title>
    <style>
        li{
            list-style-type: none;
        }
        *{
            margin: 0;
            padding: 0;
        }
        li{
            padding: 3px 5px;
            border-bottom: 2px solid #ddd;
            text-align: center;
            width: 80%;
            margin: 5px auto;
            background: #fff;
        }
        ul{
            background: #ddd;
        }
      
    </style>
</head>
<body>
    <ul>
        <li class="lilili"><span>这 <i>是</i> 一个带有事件的li</span></li>
        <li><span>这是一个带有事件的li</span></li>
        <li>这是一个带有事件的li</li>
        <li>这是一个带有事件的li</li>
        <li>这是一个带有事件的li</li>
        <li>这是一个带有事件的li</li>
        <li>这是一个带有事件的li</li>
        <li>这是一个带有事件的li</li>
        <li>这是一个带有事件的li</li>
        <li class="lilili">这是一个带有事件的li</li>
    </ul>
</body>

    <script>
        var ul = document.querySelector("ul");
        ul.addEventListener("click" , delegation(handlerClick,".lilili"));
        
        function delegation(handlerClick,selector){
            //这里是return一个函数,判断target是否是指定元素，判断是否执行handlerClick函数
            return function(evt){
                //elelist伪数组存this里的所有元素，这里的this是ul吗？？？这里的selector会跟形参冲突吗
                var elelist = this.querySelectorAll(selector);
                var e = evt || window.event;
                var target = e.target || e.srcElement;
                var temp = target;
                var targetfamily = [];
                var count = 0;
                while(true && count ++ < 100){
                    if(temp === this){
                        break;
                    }else{
                        targetfamily.push(temp);
                        temp = temp.parentNode;
                    }
                }
                console.log(targetfamily);
                for(var i = 0,ele;ele = elelist[ i++ ];){
                    if(targetfamily.length === 1 ? (target === ele) : (targetfamily.indexOf(ele) !== -1)){
                        //这个e是干嘛的？？？？？
                        handlerClick.call(ele,e);
                    }
                    
                        
                    }                                             
            }                        
        }
        function handlerClick(e){
            this.style.background = "yellow";
        }
    </script>
</html>