<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>重力回弹效果</title>
    <style>
        body{
            background-color: #000;
        }
        #box{
            height: 500px;
            width:600px;
            background-color: #fff;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            margin: auto;
        }
        #ball{
            width:40px;
            height:40px;
            border-radius: 50%;
            background-color: yellowgreen;
            position: absolute;
            top:0;
            left: 0;
        }
        #mask{
            height: 100%;
            width:100%;
            position: absolute;
            top: 0;
            left:0;
            z-index: 999;
        }
    </style>
</head>
<body>
    <div id="box">
        <div id="mask"></div>
        <div id="ball"></div>
    </div>

    <script>
        var target = 460;
        var speed = 9;
        var g = 0.5
        var speedX = 0;
        var moving = false;
        var box = document.getElementById("box");
        var ball = document.getElementById("ball");
        var timer = null;

        document.addEventListener("click" , handlerBallMove);
        box.addEventListener("mousemove" , handlerOver);

        function handlerBallMove(){
            moving = true;
            clearInterval(timer);
            ballMove();
            // handlerOut();
        }

        function ballMove(){
            timer = setInterval(function(){
                speed += g;
                ball.style.left = ball.offsetLeft + speedX + "px";
                ball.style.top = ball.offsetTop + speed + "px";
                console.log(target - ball.offsetTop,speed);
                if((target - ball.offsetTop) < speed){
                    // clearInterval(timer);
                    console.log(speed);
                    ball.style.top = target + "px";
                    speed = -speed;
                }
            },50)
        }

        function handlerOver(evt){
            var e = evt || window.event;
            if(!moving){
                ball.style.top = e.offsetY - 20 + "px";
                ball.style.left = e.offsetX - 20 + "px";
            }
            ballTurn(e.offsetX);
        }
        

        function ballTurn(x){
            if(x < 300){
                var pro = (300 - x) / 300 * 100;
                speedX = -5 * (pro / 100);
            }else{
                pro = (x - 300) / 300 * 100;
                speedX = 5 * (pro / 100);
            }
        }

    </script>
    
</body>
</html>