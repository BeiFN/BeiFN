<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        body{
            background: black;
        }
        #container{
            width: 600px;
            height: 400px;
            background: white;
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            margin: auto;
        }
        #ball{
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: radial-gradient(yellow,green);/* 径向渐变  */     
            position: absolute;
            top: 0;    
            left: 50%;
            margin-left: -40px;
        }
        #mask{
            width: 100%;
            height: 100%;
            position: absolute;
            left: 0;
            top: 0;
            z-index: 1111;
        }
    </style>
</head>
<body>
    <div id="container">
        <div id="mask"></div>
        <div id="ball"></div>

    </div>
    <script>
        //匀速下坠运动
        // var ball = document.getElementById("ball");
        // var container = document.getElementById("container");
        // var target = 400;
        // var speed = 10;
        // var timer = null;
        // container.addEventListener("click",handleClick);
        // function handleClick(){
        //     clearInterval(timer);
        //     timer = setInterval(BallMove , 50);
        // }
        // function BallMove(){
        //     if(Math.ceil(target- 40 -ball.offsetTop) < Math.ceil(speed) ){
        //         ball.style.top = target -40;
        //     }else{
        //         ball.style.top = ball.offsetTop  + speed +"px";
        //     }   
        // }
        
        //变速下坠运动+反弹
        // var ball = document.getElementById("ball");
        // var container = document.getElementById("container");
        // var target = 400;
        // var timer = null; 
        // var speed = 0;
        // var g = 0.5;
        // container.addEventListener("click",handleClick);
        // function handleClick(){
        //     clearInterval(timer);
        //     timer = setInterval(BallMove, 2);
        // }
        // function BallMove(){
        //     speed += g;
        //     if(Math.ceil(target- 40 -ball.offsetTop) <= Math.ceil(speed)){
        //         ball.style.top = target -40+"px";
        //         speed = -speed   //反弹效果
        //         ball.style.top = ball.offsetTop  + speed +"px";
        //         if(Math.ceil(speed) <=1){
        //             ball.style.top = target -40+"px";
        //         }
        //     }else{
        //         ball.style.top = ball.offsetTop  + speed +"px";
        //     }   
        // }
        
        //在鼠标的位置下落，并根据鼠标的左右滑动而改变球的方向
        var ball = document.getElementById("ball");
        var container = document.getElementById("container");
        var target = 400;
        var timer = null; 
        var speed = 0;
        var g = 0.5;
        var moving = false;
        var speedX = 0;
        document.addEventListener("click",handleClick);
        container.addEventListener("mousemove",DragBall);
        function DragBall(evt){//随着鼠标的移动，球会一直跟着，出现bug
            if(!moving){
                var e = evt || window.event;
                var offsetX = e.offsetX;
                var offsetY = e.offsetY;
                ball.style.left = offsetX +20+ "px";
                ball.style.top = offsetY -20+"px";
            }
            turnBall(offsetX);
            // console.log(offsetX)
        }
        function turnBall(x){
            if(x <= 300){
                // console.log("向左");
                var prop = (300 - x) / 300 * 100
                speedX = - 5 * (prop / 100);

          }else{
                var prop = (x - 300) / 300 * 100;
                speedX =   5 * (prop / 100);

          }
        }
        function handleClick(){
            moving = true;//点击鼠标左键后球不再跟着鼠标移动(设一个标记)
            clearInterval(timer);
            timer = setInterval(BallMove, 30);
        }
        function BallMove(){
            speed += g;
            // ball.style.top = ball.offsetLeft + speed+ "px";
            // ball.style.left = ball.offsetLeft + speedX + "px";
            if(Math.ceil(target- 40 -ball.offsetTop) <= Math.ceil(speed)){
                ball.style.top = target -40+"px";
                speed = -speed
                ball.style.top = ball.offsetTop  + speed +"px";
                if(Math.ceil(speed) <=1){
                    ball.style.top = target -40+"px";
                }
            }else{
                ball.style.top = ball.offsetTop  + speed +"px";
            }   
        }

    </script>
</body>
</html>