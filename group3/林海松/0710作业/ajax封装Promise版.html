<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <script>
            // ajax("http://localhost/0710/02json.json",{
            //     callback : function(res){
            //         console.log(res);
            //     },
            //     type : "POST" ,
            //     data : {
            //         username : "hello world",
            //         password : "123456"
            //     }
            // })
            function ajax( url , data , type){
                return new Promise(function( resolve , reject){
                    var xhr = null;
                    if(XMLHttpRequest){
                        xhr = new XMLHttpRequest();
                    }else{
                        xhr = new ActiveXObject("Mricosoft.XMLHTTP");
                    }
                    if(xhr === null) throw "浏览器不支持ajax";
                    var data_str = "";
                    for(var attr in data){
                        data_str += (data_str.length > 0 ? "&" : "?") + `${attr}=${data[attr]}`;
                    }
                    type === "GET" ? url + (/\?/.test(url) ? "&" : "?") + data_str : "";
                    xhr.open(type ? type : "GET" , url);
                    xhr.send(type==="POST" ? data_str : "null");
                    xhr.onreadystatechange = function(){
                        if(xhr.readyState === 4 && xhr.status === 200){
                            resolve(xhr.responseText);
                        }
                    }
                    setTimeout(function(){
                        reject(xhr,"超时");
                    },3000);
                })
            }
            ajax("http://localhost/0710/02json.json").then(function(res){
                console.log(res,"成功");
            },function(res){
                console.log(res);
            })
    </script>
</body>
</html>