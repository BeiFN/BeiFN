<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" /> 
		<title>ToDoList—最简单的待办事项列表</title>
		<meta name="description" content="ToDoList无须注册即可使用，数据存储在用户浏览器的html5本地数据库里，是最简单最安全的待办事项列表应用！" />
		<link rel="stylesheet" href="todo.css">
	</head>
	<body>
		<header>
			<section>
                        <label for="title">ToDoList</label>
                        <input type="text" id="title" name="title" placeholder="添加ToDo" required="required" autocomplete="off" />
			</section>
		</header>
		<section>
			<h2>正在进行 <span id="todocount">0</span></h2>
			<ol id="todolist" class="demo-box">
			</ol>
			<h2>已经完成 <span id="donecount">0</span></h2>
			<ul id="donelist">

			</ul>
		</section>

        
    <script>
        var ele_input = $("#title");
        var ele_todoList =$("#todolist");
        var ele_doneList=$("#donelist");
        var ele_todoCount=$("#todocount");
        var ele_doneCount=$("#donecount");
        
        function $(selector){
            var ele = null;
            return (ele = document.querySelectorAll(selector)).length===1?ele[0] : ele;

        }

        function addTodoItem(){
            var iptValue=ele_input.value;
            var li = createElement({
                type:"li",
                children:[
                    {
                        type:"input",
                        attr:{
                            type:"checkbox"
                        }
                    },
                    {
                        type:"p",
                        html:iptValue
                    },
                    {
                        type:"a",
                        html:"-"
                    }

                ]
            })
            li.children[0].onchange= handlerTodoToDone;
            li.children[2].onclick=removeItem;

            ele_todoList.insertBefore(li , ele_todoList.childNodes[0]);
      countLi();
        }
        function handlerTodoToDone(){
            if(this.checked)
            {
                ele_doneList.insertBefore(this.parentNode , ele_doneList.childNodes[0]);
            }
            else{
                ele_todoList.insertBefore(this.parentNode , ele_todoList.childNodes[0]);
            }
            countLi()
        }
        function removeItem(){
            this.parentNode.remove();
            countLi();
        }
function countLi(){
    var doneCount = ele_doneList.children.length;
    var todoCount = ele_todoList.children.length;
    ele_todoCount.innerHTML = todoCount;
    ele_doneCount.innerHTML = doneCount;
}
function createElement(domJson){
    typeof domJson === "undefined"? domJson = {}:"";
    var ele = document.createElement(domJson.type? domJson.type:"div");
    for(var attr in domJson.attr){
        ele.setAttribute(attr,domJson.attr[attr]);
    }
    ele.innerHTML=domJson.html? domJson.html:"";
    for (var i=0,childEle; domJson.children &&(childEle=domJson.children[i++]);){
        childEle.nodeType===1?ele.appendChild(childEle):ele.appendChild(createElement(childEle));
    }
    return ele;
}

ele_input.onkeydown=function(evt){
    var e=evt||event;
    if(e.keyCode===13){
        addTodoItem();
        ele_input.select();
    }
}

    </script>
</body>
</html>