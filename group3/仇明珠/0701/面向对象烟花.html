<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        #box {
            width: 600px;
            height: 600px;
            background: #000;
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            margin: auto;
        }

        .firework {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: red;
            position: absolute;
        }
    </style>
</head>

<body>
    <div id="box">
    </div>
    <script>
        function FireWork() { };
        FireWork.prototype.init = function (selector) {
            this.main = document.querySelector(selector);
            this.main.addEventListener("click", this.handelClick.bind(this));
        }
        FireWork.prototype.handelClick = function (evt) {
            var e = evt || window.event;
            var offsetX = e.offsetX;
            var offsetY = e.offsetY;
            var fire = this.fireInit(offsetX);
            this.FireMove(fire, offsetY, this.fireBlast.bind(this, offsetX, offsetY));

        }
        FireWork.prototype.createFire = function () {
            var fire = document.createElement("div");
            fire.className = "firework";
            return fire;
        }
        FireWork.prototype.fireInit = function (offsetX) {
            var fire = this.createFire();
            fire.style.bottom = 0;
            fire.style.left = offsetX + "px";
            fire.style.background = randomColor();
            this.main.appendChild(fire);
            return fire;
        }
        FireWork.prototype.FireMove = function (fire, offsetY, callback) {
            move(fire, {
                top: offsetY
            }, function () {
                fire.remove();
                callback();
            })
        }
        FireWork.prototype.fireBlast = function (offsetX, offsetY) {
            var fireCount = (15 + Math.round(Math.random() * 10));
            var blank = Math.round(360 / fireCount);
            var r = 50 + Math.round(Math.random() * 100);
            var angle = 0;
            for (var i = 0; i < fireCount; i++) {
                angle += blank;
                var fire = this.createFire();
                var fireX = parseInt(Math.cos(Math.PI / 180 * angle) * r + offsetX);
                var fireY = parseInt(Math.sin(Math.PI / 180 * angle) * r + offsetY);
                fire.style.left = offsetX + "px";
                fire.style.top = offsetY + "px";
                fire.style.background = randomColor();
                this.main.appendChild(fire);
                move(fire, {
                    left: fireX,
                    top: fireY,
                }, function (fire) {
                    fire.remove();
                }.bind(false, fire))
            }
        }
        function move(dom, options, callback) {
            clearInterval(dom.timer);
            dom.timer = setInterval(function () {
                for (var attr in options) {
                    if (attr === "opacity") {
                        var iNow = parseInt(getComputedStyle(dom)[attr] * 100)
                    } else {
                        var iNow = parseInt(getComputedStyle(dom)[attr]);

                    }
                    var speed = (options[attr] - iNow) / 10;
                    speed = speed > 0 ? Math.ceil(speed) : Math.floor(speed);
                    if (iNow === options[attr]) {
                        delete options[attr];
                        if (Object.keys(options).length == 0) {
                            clearInterval(dom.timer);
                            typeof callback == "function" ? callback() : "";
                        }
                    } else {
                        if (attr === "opacity") {
                            dom.style[attr] = (iNow + speed) / 100;
                        } else {
                            dom.style[attr] = iNow + speed + "px";
                        }
                    }
                }
            }, 50)
        }
        function randomColor() {
            var color = "#" + Math.round((Math.random()) * 0xffffff).toString(16);
            if (color.length != 7) {
                for (var i = 0; i < (7 - color.length); i++) {
                    color += 0;
                }
            }
            return color;
        }
        var firework = new FireWork();
        firework.init("#box");
    </script>
</body>

</html>