<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>重力回弹运动</title>
    <style>
        body{
              background: #000;
        }
        #container{
              width: 600px;
              height: 400px;
              position: absolute;
              left: 0;
              top: 0;
              right: 0;
              bottom: 0;
              margin: auto;
              background: #fff;
        }
        #ball{
              width: 40px;
              height: 40px;
              background: radial-gradient(#09f,#f19);
              border-radius: 50%;
              position: absolute;
              left: 100px;
              top: 0;
        }
        .mask{
              width: 100%;
              height: 100%;
              position: absolute;
              left: 0;
              top: 0;
              z-index: 999;
        }
        .progress{
              width: 20px;
              height: 100px;
              overflow: hidden;
              position: absolute;
              bottom: 0;
              left: 0;
              border-radius: 0 2px 2px 0;
        }
        .progress-bar{
              height: 100px;
              width: 20px;
              background:top linear-gradient(yellowgreen,#f10);
              border-radius: 0 2px 2px 0;
        }
  </style>
</head>
<div id="container">
    <body>
        <div class="mask"></div>
        <div id="ball"></div>
        <div class="progress">
            <div class="progress-bar"></div>
        </div>
    </div>

    <script>
        var timer=null;
        var speed=3;
        var g=0.5;
        var target=400;
        var speedX=0;//沿x轴方向的速度

        var moving=false;//显示运动状态的，是鼠标点还没有点
        var ball=document.getElementById("ball");
        var container=document.getElementById("container");
        var progress=document.querySelector(".progress");
        
        document.addEventListener("click",handlerClick);
        container.addEventListener("mousemove",handlerMouseMove);
        function handlerMouseMove(evt){
                  var e = evt || window.event;
                  if(!moving){
                        ball.style.left = e.offsetX - 20 + "px";
                        ball.style.top = e.offsetY - 20 + "px";
                  }
                  getBallTurn(e.offsetX);
                //   console.log(e.offsetLeft);
                //   console.log(e.offsetTop);
            }
        function getBallTurn(x){
            if(x <= 300){
                // console.log("向左");
                var prop=(300-x)/300*100;//左边的条鼠标距离线的距离
                speedX=-5*(prop/100);
            }else{
                // console.log("向右");
                var prop= (x-300)/300*100;
                speedX= 5*(prop/100);
            }
            // console.log(prop);
            progress.style.height=prop+"px";
        }

        function handlerClick(){
            moving=true;
            clearInterval(timer);
            timer=setInterval(ballMove,50);
        }

        function ballMove(){
            speed += g;

            ball.style.top = ball.offsetTop + speed + "px";
            ball.style.left = ball.offsetLeft + speedX + "px";
            // console.log(ball.offsetLeft);
            // console.log(ball.offsetTop);
                     
            if(Math.abs(target-40-ball.offsetTop) <= speed ){
                ball.style.top = target - 40 + "px";
                speed=-speed;

                if(speed>-2){
                    clearInterval(timer);
                    ball.style.top=target-40+"px";
                }
            }
        }
    </script>
    
</body>
</html>