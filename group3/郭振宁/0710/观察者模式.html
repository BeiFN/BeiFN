<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <script>
        class Observer {
            constructor(age , name) {
                this.name = name;
                this.age = age;
            }
            accept(msg) {
                console.log(`我是${this.name},我接受到了消息${msg}`);
            }
        }

        class Publisher {
            constructor() {
                this.list = {
                    12 : [],
                    18 : [],
                    all : []
                }
            }
            publish(age , msg) {
                let type = "all";
                if(age >= 12 && age < 18) {
                    type = 12;
                }
                if(age >= 18) {
                    type = 18;
                }
                this.list[type].forEach( obs => {
                    obs.accept(msg);
                })
            }
            add(age , obs) {
                if(age >= 12 && age < 18) {
                    this.list[12].push(obs);
                }
                if(age >= 18) {
                    this.list[18].push(obs);
                }
                this.list["all"].push(obs);
            }
            dele(obs) {
                console.log("haha");
                for(var attr in this.list) {
                        if(this.list[attr].indexOf(obs) !== -1) {
                            this.list[attr].splice(attr.indexOf(obs) , 1);
                     }
                }
            }
        }


        var obs1 = new Observer(15 , "小芳");
        var obs2 = new Observer(18 , "小名");
        var obs3 = new Observer(12 , "小只");
        var obs4 = new Observer(138 , "小留");

        var publish = new Publisher();

        publish.add(15 , obs1);
        publish.add(18 , obs2);
        publish.add(12 , obs3);
        publish.add(138 , obs4);


    </script>
    
</body>
</html>