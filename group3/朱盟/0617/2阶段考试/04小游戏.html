<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title> 小游戏 ！emb</title>

    <style>
        * {
            margin: 0px;
            padding: 0px;
        }

        #box {
            width: 540px;
            height: 200px;
            position: absolute;
            top: 0px;
            bottom: 0px;
            left: 0px;
            right: 0px;
            margin: auto;
            border: 1px solid #999;
            border-radius: 5px;
            font-size: 1em;
            text-align: start;
            overflow: auto;
            resize: both;
        }

        button {
            position: fixed;
            bottom: 20%;
            right: 30%;
            border: 1px solid #666;
            background: #666;
            color: white;
            border-radius: 3px;
            display: inline-block;
            width: 80px;
            height: 30px;
        }
        button#reok{
            bottom: 12%;
        }
        i {
            font-style: normal;
            color: red;
        }
        m{
            font-style: normal;
            color: #999;
        }
    </style>
</head>

<body>


    <!-- 老师因为编码原因 我只能写英文 重新编码了，如果您看到乱码，请重新编码，请谅解！ -->





    <div id="box">

    </div>
    <button id="ok">
        Start Game!
    </button>
    <button id="reok">
        Restart!
    </button>

    <script>
        // 对象声明
        // 人 
        var person = {
            name: "宝宝",
            hp: 100
        }

        //发生事件
        var eventList = [{
                type: "吃了一颗毒蘑菇",
                harm: 20
            },
            {
                type: "走路崴了脚",
                harm: 2
            },
            {
                type: "淋雨感了冒",
                harm: 5
            }
        ]

        // 人物死亡方式列表
        var dieList = ["狗带了", "玩完了", "去世了"];
        // var gamePlayer = new person();

        //输出到页面
        function println(str) {
            var s = box.innerHTML;
            box.innerHTML = s + str + "<br>";
        }

        //随机数
        function randomNumber(min, max) {
            return min + Math.round(Math.random() * (max - min));
        }
        // 随机对象
        function objectRandom(o) {
            var i = randomNumber(0, o.length - 1);
            var count = 0;
            for (const key in o) {
                if (count === i) return o[key];
                count++;
            }
        }


        // 游戏发生器
        var gameStep=[];
        ok.onclick = function () {
            var count=0;
            while (true) {
                count++
                var personDo = objectRandom(eventList);
                var printStr0 = "<m> 第"+count+"天   ：</m>"+person.name + "   因为  " + personDo.type + "  而减少了 <i> " + personDo.harm +
                    "</i>,   " + "";
                person.hp -= personDo.harm;
                var printStr1 = "血量剩余<i> " + person.hp + "</i>!";
                if (person.hp <= 0) {
                    var personDeth = dieList[randomNumber(0, eventList.length)];
                    printStr1 = "<i>"+personDeth + "，游戏结束！</i>";
                    gameStep.push(printStr0 + printStr1);
                    // println(printStr0 + printStr1);
                    break;
                }else{
                    gameStep.push(printStr0 + printStr1);
                    // println(printStr0 + printStr1);
                }
                
            }
            
            var step=0;
            var tiemer=setInterval(function(){
                if(step>gameStep.length-1){
                    clearTimeout(tiemer);
                }else{
                    println(gameStep[step]);
                    step++;
                }
               
            },1000);

        }


        reok.onclick=function(){
           person.hp=100;
           box.innerHTML="";
           gameStep=[];
        }
    </script>
</body>

</html>