<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="style/msqq.css">
    <title>msn EMB </title>
</head>

<body>

    <div class="box">
        <div class="boxl">
            <ul>
                <li></li>
                <li></li>
                <li></li>
            </ul>
        </div>
        <div class="boxr">
            <ul class="t">
                <li>To : 吃火星的宝宝
                </li>

                <li id="escstate">ENTER 激活
                </li>
            </ul>
            <div id="mslist" class="mslist">
                <div class="msitem l">
                    你好啊！
                </div>

            </div>
            <div class="msin">
                <ul>
                    <li class="ico">
                        <img src="img/时钟.png" width="24" alt="">
                    </li>

                    <li class="ico">
                        <img src="img/文件.png" width="24" alt="">
                    </li>
                    <li class="ico">
                        <img src="img/表情.png" width="24" alt="">
                    </li>
                    <li id="sendBt" class="ico" style="float: right"><img src="img/发送.png" width="28" alt="">
                    </li>
                </ul>

                <textarea name="" id="msta" cols="30" rows="10" placeholder="输入您的发送内容。tip:ESC 键可以帮助你修改 ENTER 键的发送功能！ "></textarea>
            </div>

        </div>
    </div>


    <script src="js/abstract.js"></script>
    <script>
        var ele_txt = $("#msta");
        var ele_mslist = $("#mslist");
        var ele_sendbt = $("#sendBt");
        var ele_escsta=$("#escstate");
        var isEnterSend = true;
        ele_sendbt.onclick = sendHandler;

        document.onkeydown = function (ev) {
            var e = ev || window.event;
            if (e.keyCode === 27) {
                isEnterSend ? isEnterSend = false : isEnterSend = true;
                
                if(isEnterSend){
                    ele_escsta.innerHTML="ENTER 激活"
                }else{
                    ele_escsta.innerHTML="ENTER 关闭";
                }
                console.log("Enter Send State:" + isEnterSend);
            }
            if (e.keyCode === 13) {
                isEnterSend ? sendHandler() : "";
            }

        }


        function sendHandler() {

            var msVal = ele_txt.value;
            if (msVal.trim().length < 1) return false;
            var msBox = createElement({
                tagName: "div",
                attr: {
                    class: "msitem r"
                },
                html: msVal
            });

            ele_mslist.appendChild(msBox);
            msBox.scrollIntoView();
            ele_txt.value = "";
            ele_txt.focus();
            // console.log(ele_mslist);
        }
    </script>

</body>

</html>