<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        body,
        html {
            width: 100%;
            height: 100%;
            background: #333;
        }

        .fire_work {
            width: 10px;
            height: 10px;
            position: absolute;
            left: 0;
            border-radius: 50%;
        }
    </style>
</head>

<body id="body">
    <script src="../ku/hanshuku.js"></script>
    <script>
        function Firework() {
            this.bindEvent();
        }
        // 事件绑定
        Firework.prototype.bindEvent = function () {
            body.addEventListener("click", this.init.bind(this));
        }
        // 初始化
        Firework.prototype.init = function (evt) {
            var e = evt || window.event;
            this.fire = this.createFire();
            this.fire.style.left = e.offsetX + "px";
            this.fire.style.bottom = 0;
            this.fireUp(e.offsetX, e.offsetY);
            this.timer = null;
        }
        // 创造烟花
        Firework.prototype.createFire = function () {
            var fire = document.createElement("div");
            fire.className = "fire_work";
            fire.style.background = randomColor(1);
            document.body.append(fire);
            return fire;
        }
        // 升空
        Firework.prototype.fireUp = function (offsetX, offsetY) {
            // clearInterval(this.timer);
            this.timer = move(buffer(this.fire, { top: offsetY }, this.fireBoom.bind(this, offsetX, offsetY)));
        }
        // 爆炸
        Firework.prototype.fireBoom = function (offsetX, offsetY) {
            this.fire.remove();
            var count = 20 * Math.PI,
                arr = [],
                size = Math.round(Math.random()+1);
            for (var i = -count; i <= count; i += 1.5) {
                var fire = this.createFire();
                fire.style.left = offsetX + "px";
                fire.style.top = offsetY + "px";
                var fireY = (-60 * (2 * Math.cos(i) - Math.cos(2 * i)) + offsetY) * size, //横坐标终点      半径*cos（角度*π/180）
                    fireX = (60 * (2 * Math.sin(i) - Math.sin(2 * i)) + offsetX) * size; //纵坐标终点
                arr.push(buffer(fire, { top: fireY, left: fireX, opacity: [.2, 10] }, function () { this.remove() }.bind(fire)));
            }
            // clearInterval(this.timer);
            this.timer = move(arr);
        }
        Firework.prototype.autoFire = function () {

        }
        // Firework.prototype.init = function () {

        // }
        // Firework.prototype.init = function () {

        // }
        // Firework.prototype.init = function () {

        // }
        // Firework.prototype.init = function () {

        // }
        var firework = new Firework();

    </script>
</body>

</html>