<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>
    <script>
        //观察者
        class Observer {
            constructor(name, age) {
                this.name = name;
                this.age = age;
            }
            accept(msg) {
                console.log(`我是${this.name},我接受到了消息${msg}`);
            }
        }
        //发布者
        class Publisher {
            constructor() {
                this.list = {
                    12: [],
                    18: [],
                    all: []
                };
            }
            //发布
            publish(msg, age) {
                let type = "all";
                if (age >= 12 && age < 18) {
                    type = 12;
                }
                if (age >= 18) {
                    type = 18;
                }
                this.list[type].forEach(obs => {
                    obs.accept(msg);
                });
            }
            //订阅
            subscrible(obs, age) {
                if (age >= 18) {
                    this.list[18].push(obs)
                }
                if (age >= 12 && age < 18) {
                    this.list[12].push(obs)
                }
                this.list["all"].push(obs)
            }
            //移除订阅功能
            unsubscrible(obs) {
                this.list.splice(this.list.indexOf(obs), 1);
            }
        }

        let obs1 = new Observer("xgr", 18);
        let obs2 = new Observer("qq", 20);
        let obs3 = new Observer("heh", 15);
        let obs4 = new Observer("yj", 17);
        // console.log(obs1)

        let pub = new Publisher();
        pub.subscrible(obs1, obs1.age);
        pub.subscrible(obs2, obs2.age);
        pub.subscrible(obs3, obs3.age);
        pub.subscrible(obs4, obs4.age);

    </script>
</body>

</html>