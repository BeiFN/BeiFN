<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
            *{
                  margin: 0;
                  padding: 0;
            }
            .container{
                  width: 800px;
                  height: 600px;
                  margin: 50px auto 0 auto;
                  border: 1px solid #ddd;
            }
            .left,.right {
                  width: 40%;
                  height: 100%;
                  background: #ddd;
                  float: left;
            }
            .left p ,.right p{
                  display: block;
                  padding-left: 5px;
                  border-bottom: 1px solid #fff;
                  height: 40px;
                  line-height: 40px;
            }
            .right {
                  float:right;
            }
            #menu{
                  width:100px;
                  height: 100px;
                  border-radius: 5px;
                  border: 2px solid #000;
                  box-shadow: 0 0 5px #ddd;
                  position: absolute;
                  left: 0;
                  top: 0;
                  z-index: 999;
                  display: none;
                  background: #fff;
            }
            #menu p{
                  line-height: 24px;
                  border-bottom: 1px solid #ddd;
                  text-align: center;
                  transition: all .5s;
            }
            #menu p:hover{
                  box-shadow: 0 0 5px #000;
                  background: #ddd;
            }
      </style>
</head>
<body>
        <div class="container">
                <div class="left">
                      <p>hello world1</p>
                      <p>hello world2</p>
                      <p>hello world3</p>
                      <p>hello world4</p>
                </div>
                <div class="right">
                </div>
          </div>
          <div id="menu">
                <p>复制</p>
                <p>剪切</p>
                <p>粘贴</p>
                <p>删除</p>
          </div>
          <script>
 /**
 * 思路 :
 * 1. 当鼠标右键点击的时候阻止默认事件;
 * 2. 显示菜单并定位菜单;
 * 3. 菜单选项被选中的时候，隐藏菜单;
 * 前置技能 ?  =>  谁 ????
 * 4. 复制 ?? 粘贴 ??? 剪切 ??? 删除 ???
 */
/**  
 * 事件发生在谁的身上 ? => 事件源的查看;
 */
// document.addEventListener("click",eventTarget);
// function eventTarget(evt){
//       var e = evt || window.event;
//       // console.log(e.target);// 事件源;
//       var target = e.target || e.srcElement;
//       // console.log(target);
// }
/**
 * @var container  外包围元素 => div
 * @var option_ele 保存的要操作的元素;
 * @var option_btns 所有的操作按钮; => 已经转换成真数组;
 * @var option_type 操作状态 => cut copy
 * @var clone_ele   复制缓存 => options_ele 的clone 
 * @var allow_eles   允许操作的列表 => 预先选中和操作之中被允许的元素 => 转换成真数组; 
 * @var right       右侧列表 => div
 * @var option_btns  邮件菜单的按钮 => p;
 */
/**  
 * 事件 => 业务 
 *         业务
 */

 var 
      container = document.querySelector(".container"),
      menu = document.getElementById("menu"),
      option_type = "copy",
      option_ele = null,
      clone_ele = null,
      allow_eles = document.querySelector(".left").children,
      right = document.querySelector(".right"),
      option_btns = [].slice.call(menu.children);
      allow_eles = [].slice.call(allow_eles);

/**
 * @function  showMenu   阻止默认事件显示并定位菜单
 * @function  hideMenu   隐藏菜单,辨别操作是否允许 => 根据allow_eles实现 => 操作分配; 
 * @function  remove     删除option_ele;
 * @function  cut        状态改变 option_type,透明度改变 option_ele；
 * @function  copy       创建一个克隆 , 放在了 clone_ele;
 * @function  paste      粘贴 : 根据状态 option_type 决定 操作
 **/ 

      function showMenu(evt){
            var e = evt || window.event;
            e.preventDefault ? e.preventDefault() : e.retrunValue = false;

            var clientX = e.clientX;
            var clientY = e.clientY;
            var target = e.target || e.srcElement;
            menu.style.display = "block";
            menu.style.left = clientX + "px";
            menu.style.top = clientY + "px";
            // 阻止默认事件的简写方法 => return false
            if(allow_eles.indexOf(target) === -1){
                  return 0;
            }
            option_ele = target;
            console.log(option_ele);
      }
      function hideMenu(evt){
            var e = evt || window.event;
            menu.style.display = "none";
            var target = e.target || e.srcElement;
            // target => 一个元素的地址;
            var eventCode = option_btns.indexOf(target);
            //option_btns = [ ele, ele, ele , ele] 
            // indexOf ;
            if(eventCode === -1){
                  return 0;
            }
            switch(eventCode){
                  case 0 : copy(); break;
                  case 1 : cut() ; break;
                  case 2 : paste(); break;
                  case 3 : remove(); break;
            }
      }
      function remove(){
            option_ele.remove();
      }
      function copy(){
            if(option_ele === null){
                  return 0;
            }
            clone_ele = option_ele.cloneNode(true);
            // 让元素允许操作;
            allow_eles.push(clone_ele);
            option_type = "copy";
      }
      function cut(){
            if(option_ele === null){
                  return 0;
            }
            option_type = "cut";
            option_ele.style.opacity = 0.3;
      }
      function paste(){
            if(option_type === "copy"){
                  right.appendChild(clone_ele);
                  clone_ele = null;
            }    
            if(option_type === "cut"){
                  right.appendChild(option_ele);
                  option_ele.style.opacity = 1;
            }
      }
      container.addEventListener("contextmenu",showMenu)
      document.addEventListener("click",hideMenu)
      // var obj = {};
      // // obj =>  地址;
      // var menu = document.getElementById("menu");
      // var menu2 = document.getElementById("menu");
      // menu === menu2  // true;    
</script>
</body>
</html>