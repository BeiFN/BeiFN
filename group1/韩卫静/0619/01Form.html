<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>综合表单验证</title>
    <style>
        body{background-color: #333}
        #formBox{width: 500px;height: 500px; margin: 0 auto;}
        h4{font-size: 16px; color: rgb(6, 158, 207);}
        p{margin: 20px;font-size: 14px; line-height: 20px;}
        span{color: #999; display: inline-block; width: 150px;}
        input{width: 200px; background-color: #999; border: 0; color: #333; border-radius: 2px;}
        i{font-style: normal;color: red;}
        .submit{ text-align: center;}
        .submit input{width: auto; }
        .submit span{width: auto; text-align: left;}
        .submit button{width: 80px; height: 30px; border: 0; border-radius: 5px;background-color:rgb(6, 188, 227);
        font-size: 14px;color: #fff;line-height: 30px;}
        #notice{width: 200px; height: 20px;font-size: 12px;text-align: center; border-radius: 4px; background-color: #ffc; position: absolute; top: 5px; left: 45%; }
        #yanzhengma{width: 100px;}
        #randomNum{margin-left: 30px; background-color: #fff;width: 60px;}
    </style>
</head>
<body>
    <div id="formBox" >
        <h4>账户详细资料</h4>
        <div id="notice">

        </div>
        <div class="idInfo">
            <p><span>用户名称</span><i>*</i> <input id="uName" type="text"></p>
            <p><span>登录密码</span><i>*</i> <input id="passwd" type="password"></p>
            <p><span>重复登录密码</span><i>*</i> <input id="rePasswd" type="password"></p>
            <p><span>密码安全级别</span><i>*</i> <span id="lspan"></span></p>
        </div>
        <h4>个人详细资料</h4>
        <div class="perInfo">
            <p><span>电子邮件</span><i>*</i> <input id="email" type="text"></p>
            <p><span>真实姓名</span><i>*</i> <input id="realName" type="text"></p>
            <p><span>中奖通知手机</span><i>*</i> <input id="phone" type="text"></p>
            <p><span>验证码</span><i>*</i> <input id="yanzhengma" type="text"> <span id="randomNum"></span></p>
        </div>
        <div class="submit">
            <button id="btnSubmit">注册</button>
            <input type="checkbox"><span>10天内免登录</span>
        </div>
    </div>


    <script>
        // 用来校验每项是否填写正确
        var verify = [0,0,0,0,0,1];
        //提示框显示
        var not = document.getElementById("notice");
        //用户名识别----------------------------------------------------------
        function checkUserName(){
            var username = uName.value;
            //用户名长度6-20
            if(username.length < 6 || username.length > 20) {
                not.innerHTML = "用户名长度为6-20位！";
                verify[0] = 0;
                return 0;
            }
            //数字不能开头
            if(username.charCodeAt(0) >= 48 && username.charCodeAt(0) <= 57){
                notice.innerHTML = "用户名不可以用数字开头！！";
                verify[0] = 0;
                return 0;
            } 
            //只能包含数字、字母、下划线
            for(var i in username) {
                var asc = username.charCodeAt(i);
                //48-57   65-90   97-122 95
                if( (asc>=48&&asc<=57) || (asc>=65&&asc<=90) || (asc>=97&&asc<=122) || asc==95 ) {

                } else {
                    notice.innerHTML = "用户名只能使用数字字母下划线";
                    verify[0] = 0;
                    return 0;
                }
            }
            notice.innerHTML = "用户名正确";
            verify[0] = 1;
        }
        uName.onblur  = checkUserName;

        //密码强度判断----------------------------------------------------
        passwd.oninput  = function(){
            var str = passwd.value;
            var level = 0;
            for(var i in str){
                var asc = str.charCodeAt(i);
                if( (asc>=65&&asc<=90) || (asc>=97&&asc<=122)){
                    level += 2;
                }else if(asc>=48&&asc<=57){
                    level += 1;
                }else if(asc>=35&&asc<=47){
                    level += 3;
                }
            }

            if(level <=8){
                lspan.style.background = "#e00";
                lspan.innerHTML = "弱";
            }else if(level >8 && level <17){
                lspan.style.background = "#ee0";
                lspan.innerHTML = "中";
            }else if(level >= 17){
                lspan.style.background = "#0e0";
                lspan.innerHTML = "强";
            }
        }

        //重复密码判断
        rePasswd.onblur = function(){
            var repeatPwd = rePasswd.value;
            var str = passwd.value;
            if(str === repeatPwd){
                notice.innerHTML = "密码校验成功！";
                verify[1] = 1;
                return 0;
            }
            notice.innerHTML = "密码匹配错误！";
            verify[1] = 0;
        }
        //电子邮件判断
        email.onblur = function(){
            var eM = email.value;
            for(var i in eM){
                var asc = eM.charCodeAt(i);
                if( asc === 64){
                    verify[2] = 1;
                    notice.innerHTML = "电子邮件校验成功";
                    return 0;
                }
            }
            notice.innerHTML = "电子邮件格式错误";
            verify[2] = 0;
        }
        //真实姓名判断---------------
        realName.onblur = function(){
            var rName = realName.value;
            if( rName ){
                verify[3] = 1;
                notice.innerHTML = "姓名校验成功";
                return 0;
            }else{
                verify[3] = 0;
                notice.innerHTML = "姓名不能为空";
            }
        }
        //手机号码判断------------------------------
        phone.onblur = function(){
            var ph = phone.value;
            if( ph.length != 11 ){
                verify[4] = 0;
                notice.innerHTML = "手机号码必须为11位";
                return 0;
            }
            if( !Number(ph) ){
                verify[4] = 0;
                notice.innerHTML = "手机号码必须为纯数字";
                return 0;
            }
            verify[4] = 1;
            notice.innerHTML = "手机号码校验成功";
        }

        //验证码------------------------------
        randomNum.innerHTML = parseInt(Math.random()*9000 + 1000);
        yanzhengma.onblur = function(){
            var yanz = yanzhengma.value;
            var ran = randomNum.innerText ;
            if(yanz === ran){
                verify[5] = 1;
                notice.innerHTML = "验证码填写正确！";
                return 0;
            }
            verify[5] = 0;
            notice.innerHTML = "验证码匹配错误";
            randomNum.innerHTML = parseInt(Math.random()*9000 + 1000);
        }
        
        //按钮提交-------------------------------------

        btnSubmit.onclick = function(){
            for(var i in verify){
                if(verify[i] === 0){
                    notice.innerHTML = "请完整填写表单后提交";
                    return 0;      
                }
            }
            console.log(666);
            uName.value = "";
            passwd.value = "";
            rePasswd.value = "";
            email.value = "";
            realName.value = "";
            phone.value = "";
            yanzhengma.value = "";
            notice.innerHTML = "已成功提交";
            alert("提交成功");      
        }
    </script>
</body>
</html>