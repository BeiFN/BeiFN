<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>彩色泡泡</title>
		 <style>
			 *{
				 margin: 0;
				 padding: 0;
			 }
            .ball{
                  width: 20px;
                  height: 20px;
                  border-radius: 50%;
                  background: radial-gradient(#fff,#000);
                  position: absolute;
            }
			
      </style>
	</head>
	
	<body>
		
		<script type="text/javascript">
			// 1. 鼠标按下;鼠标抬起;
            // 2. 创建粒子小球。 鼠标抬起终止创建.
            // 3. 小球运动;
			
			
			class Particle{
				
				constructor() {
					this.main_ele=document;
					
				    this.cLientW=document.documentElement.clientWidth;
				    this.cLientH=document.documentElement.clientHeight;
				    this.timer=null;
				    this.main_ele.addEventListener("mousedown",this.handlerClick.bind(this));
				    this.main_ele.addEventListener("mouseup",this.stopCreateParticle.bind(this));
				    this.main_ele.addEventListener("mousemove",this.getFollowing.bind(this));
				}
				
				// 球源的起点位置可以跟着鼠标位置的改变而改变
				getFollowing(evt){
					var e=evt || window.event;
					this.offsetx=e.clientX;
					this.offsety=e.clientY;
				}
				
				// 处理鼠标点击函数,创建小球让小球发生运动
				handlerClick(evt){
					var e=evt||window.event;
					this.offsetx=e.offsetX;
					this.offsety=e.offsetY;
					console.log(this.offsetx,this.offsety);
					this.timer=setInterval(function(){
						var ball=this.createParticle();
						setTimeout(function(){
							this.ballMove(ball,this.offsety);
						}.bind(this),100);
					}.bind(this),80)
				}
				
				// 创建好多的小球; 
				// => 定时器;
				createParticle(){
					var ball=document.createElement("div");
					ball.className="ball";
					ball.style.background="#"+Math.round(Math.random()*parseInt("ffffff",16)).toString(16).padStart(6,"0");
					ball.style.left=this.offsetx+"px";
					ball.style.top=this.offsety+"px";
					ball.style.transition="all 1s";	
					document.body.appendChild(ball);
					return ball;	  //-->返回值
				}
				
				// 让球在球源以下的随机的位置上运动,停留1s之后删除
				ballMove(ball,minLine){
					var randomL=Math.round(Math.random()*this.cLientW);
					var randomT=this.offsety+Math.round(Math.random()*(this.cLientH-this.offsety));
					ball.style.left= randomL + "px";
					ball.style.top= randomT + "px";
					ball.style.opacity=0.2;
					setTimeout(function(){
						ball.remove();
					},1000);	
				}
				
				// 停止创建小球,就是清除定时器
				stopCreateParticle=function(){
					clearInterval(this.timer);
				}
				
			}
	
		   new Particle();
		   
		</script>
	</body>
</html>
