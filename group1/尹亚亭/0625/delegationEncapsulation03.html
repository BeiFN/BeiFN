<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>事件委托的高级封装</title>
	</head>
	<body>

		<button class="btn"><strong>这是一个按钮</strong> ,只有这些按钮可以实现增加元素的功能</button>
		<button class="btn">这是一个按钮,只有这些按钮可以实现增加元素的功能</button>
		<button class="btn">这是一个按钮,只有这些按钮可以实现增加元素的功能</button>
		<button class="btn">这是一个按钮,只有这些按钮可以实现增加元素的功能</button>
		<button>这是一个按钮</button>
		<button>这是一个按钮</button>
		<button>这是一个按钮</button>
		<button>这是一个按钮</button>
		<button>这是一个按钮</button>
		<button>这是一个按钮</button>
		<button>这是一个按钮</button>

		<script type="text/javascript">
			
			document.body.addEventListener("click", deleagation(createButton, ".btn"))
			
			function deleagation(eventCallback, selector) {
				// 给事件调用的函数;
				return function(evt) {
					var e = evt || window.event;
					
					var target = e.target || e.srcElement;	
					// 限定选择范围;
					var targetFamily = [];	
					var _tempTarget = target;
					// 向父级去进行找寻;
					while (true) {
						if (_tempTarget === this) {		
							break;
						}
						targetFamily.push(_tempTarget);
						
						_tempTarget = _tempTarget.parentNode;
					}
					var eleList = this.querySelectorAll(selector);
					// 在这里改成了判定条件的升级;
					for (var i = 0, ele; ele = eleList[i++];) {
						if (targetFamily.length === 1 ? (ele === target) : (targetFamily.indexOf(ele) !== -1)) {
							eventCallback.call(ele,e);	
						}
					}
				}
			}


			function createButton(){
                  var 
                        ele = document.createElement("button");
                        ele.innerHTML = "一个新按钮"
                        document.body.appendChild(ele);
				
            }
			
			
		</script>
	</body>
</html>
