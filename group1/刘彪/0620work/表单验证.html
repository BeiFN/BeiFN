<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="public.css">
    <link rel="stylesheet" href="index.css">
</head>

<body>
    <form action="" id="form">
        <div id="notBoard">
        </div>
        <div id="notBoard2">
        </div>
        <h5>注意*为必填项</h5>
        <fieldset>
            <legend>账户详细资料</legend>
            <div id="box"><span>用户名称</span> <input type="text" id="userName"> <span id="star">*</span></div>
            <div id="box"><span>登陆密码</span> <input type="password" id="psd"> <span id="star">*</span></div>
            <div id="box"><span>重复登陆密码</span> <input type="password" id="repsd"><span id="star">*</span> </div>
            <div id="box"><span>密码安全级别</span>
                <div id="levelBar">
                    <div>弱</div>
                    <div>中</div>
                    <div>强</div>
                </div><span id="star">*</span>
            </div>
        </fieldset>
        <fieldset>
            <legend>个人信息资料</legend>
            <div id="box"><span>电子邮箱</span> <input type="text" id="mail"><span id="star">*</span> </div>
            <div id="box"><span>真实姓名</span> <input type="text" id="realname"><span id="star">*</span></div>
            <div id="box"><span>中奖通知手机</span> <input type="text" id="phone"><span id="star">*</span></div>
            <div id="box"><span>验证码</span>
                <div id="ma">
                    <div>****</div>
                    <input id="iptma" type="text">
                </div>
                <div id="star">*</div>
            </div>
        </fieldset>
        <button id="btn">注册</button> <input id="check" type="checkbox"><span>10天内免登录</span>

    </form>
    </div>

    <script>
        var check = document.getElementById("check");
        check.style.cssText = " width:15px;height: 15px;float: none;margin:0";

        //用户名验证
        userName.onchange = nameCheck;
        function nameCheck() {
            var userName = document.getElementById("userName").value;
            //用户长度6-20
            if (userName.length < 6 || userName.length > 20) {
                notBoard.innerHTML = "用户名长度要在6-20位!";
                notBoard.style.display = "block";
            }
            else if (userName.charCodeAt(0) >= 48 && userName.charCodeAt(0) <= 57) {
                notBoard.innerHTML = "用户名不能数字开头!";
                notBoard.style.display = "block";
            }
            else {
                notBoard.style.display = "none";
            }
            //只能包含数字、字母、下划线
            for (var i in userName) {
                var asc = userName.charCodeAt(i);
                //48-57   65-90   97-122 95
                if ((asc >= 48 && asc <= 57) || (asc >= 65 && asc <= 90) || (asc >= 97 && asc <= 122) || asc == 95) {

                } else {
                    notBoard.innerHTML = "用户名不能有特殊符号!";
                    notBoard.style.display = "block";
                    break;
                }
            }
        }

        //密码验证
        psd.onchange = psdCheck;

        function psdCheck() {
            var psd = document.getElementById("psd").value;

            //密码长度在8-20之间
            if (psd.length < 5 || psd.length > 20) {
                notBoard.innerHTML = "密码长度要在8-12位!";
                notBoard.style.display = "block";
            } else {
                notBoard.style.display = "none";
            }

            for (var i in psd) {
                var asc = psd.charCodeAt(i);
                //48-57 数字/ 65-90 大写字母 /97-122 小写字母/33-47  符号
                if ((asc >= 48 && asc <= 57) || (asc >= 65 && asc <= 90) || (asc >= 97 && asc <= 122) || (asc >= 33 && asc <= 47)) {

                } else {
                    notBoard.innerHTML = "密码中不能有特殊字符!";
                    notBoard.style.display = "block";
                    break;
                }
            }
        }

        //确认密码验证
        repsd.onchange = repsdCheck;

        function repsdCheck() {
            var psd = document.getElementById("psd").value;
            var repsd = document.getElementById("repsd").value;

            if (psd === repsd) {
                notBoard.style.display = "none";

                //判断强度
                var race = {
                    num: false,
                    Upletter: false,
                    Lowletter: false
                }


                for (var i = 0, letter; letter = psd[i++];) {

                    if (letter >= 0 && letter <= 9 && !race.num) {
                        race.num = true;
                    }
                    if (letter >= 'A' && letter <= 'Z' && !race.Upletter) {

                        race.Upletter = true;
                    }

                    if (letter >= 'a' && letter <= 'z' && !race.Lowletter) {
                        race.Lowletter = true;

                    }
                }

                var count = 0;
                var bars = document.getElementById("levelBar").children;
                for (var index in race) {
                    if (race[index]) {
                        count++;
                        bars[count - 1].style.background = "orange";
                    }
                }

            } else {
                notBoard.innerHTML = "两次密码输入不同!";
                notBoard.style.display = "block";
            }
        }

        //邮箱验证
        mail.onchange = mailCheck;

        function mailCheck() {

            var mainlValue = document.getElementById("mail").value;
            var flag = 0;
            for (var i = 0, letter; letter = mainlValue[i++];) {
                //要包含@
                if (letter === "@") {
                    flag = 1;
                }
            }

            if (flag) {
                notBoard2.style.display = "none";

            }
            else {
                notBoard2.innerHTML = "邮箱输入的格式不正确";
                notBoard2.style.display = "block"
            }

        }

        //姓名验证
        realname.onchange = rlnameCheck;

        function rlnameCheck() {

            var nameValue = document.getElementById("realname").value;
            //只能含有汉字,不能含有数字,字母,符号
            for (var i = 0, letter; letter = nameValue[i++];) {
                if (letter.charCodeAt() >= 33 && letter.charCodeAt() <= 126) {
                    notBoard2.innerHTML = "名字输入的格式不正确";
                    notBoard2.style.display = "block";
                    break;
                }
                else {
                    notBoard2.style.display = "none"
                }
            }
        }

        //手机验证
        phone.onchange = phoneCheck;
        function phoneCheck() {
            var phoneValue = document.getElementById("phone").value;
            //长度必须11位
            //只能是数字
            for (var i = 0, letter; letter = phoneValue[i++];) {
                if (letter >= "0" && letter <= "9" && phoneValue.length == 11) {
                    notBoard2.innerHTML = "请输入验证码";
                    notBoard2.style.display = "block";
                    producema();
                }
                else {
                    notBoard2.innerHTML = "手机号格式不正确";
                    notBoard2.style.display = "block";
                    break;
                }
            }
        }
     
        function producema() {
            //生成验证码
            var maValue =document.getElementById("ma").children[0];
            var randomMa = parseInt(Math.random() * 10000);
            maValue.innerHTML = randomMa.toString().padStart(4, "0");
            console.log(maValue.innerHTML)

        }

        //验证码验证
        iptma.onchange = maCheck;

        function maCheck() {
            var iptValue = document.getElementById("iptma").value;
            var maValue = document.getElementById("ma").children[0].innerHTML;
            console.log(iptValue, maValue);

            if (iptValue == maValue) {

                notBoard2.innerHTML = "验证码正确,请点击注册";
                notBoard2.style.display = "block";
            } else {
                notBoard2.innerHTML = "验证码错误,请重新输入";
                notBoard2.style.display = "block";
                //生成验证码
                var randomMa = parseInt(Math.random() * 10000);
                maValue.innerHTML = randomMa.toString().padStart(4, "0");
            }

        }

        //注册验证
        btn.onclick = btnCheck;
        function btnCheck(){
            var boardValue = notBoard2.innerHTML;
            
            var notBoard = document.getElementById("notBoard");

            // var boardDisplay = notBoard.getAttribute("display");

             var boardDisplay=window.getComputedStyle(notBoard,null).getPropertyValue("display");

            console.log(boardDisplay);

            var str ="验证码正确,请点击注册";
            if(boardValue==str&&boardDisplay=="none"){
            alert("注册成功");
        }
        else{
            alert("信息有误");
        }

        }




    </script>








</body>

</html>