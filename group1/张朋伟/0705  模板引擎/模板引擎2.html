<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>2222</title>
</head>

<body>

</body>
<script type="text/html" id="template">
    <% for(var attr in data){ %>
    <h2>hello world <%= data[attr].a %></h2>
    <% } %>
</script>

<script>
    // var cont = document.getElementById("template").innerHTML;
    // console.log(cont);

        function my_template(cont, date) {
            //js 正则
            var regJS = /<%[^=](.*?)%>/g;
            //匹配变量 正则
            var regVal = /<%[=](.*?)%>/g;

            //js匹配
            var res = cont.replace(regJS, ` \`);$1 print(\` `);
            //拼接前后print()
            res = `print(\`${res}\`)`;
            //变量匹配
            res = res.replace(regVal, ` \`)print(data[attr].a);print(\` `);
            // console.log(res)
            console.log(res)

            // console.log(res);
            var html = "";
            // print就是拼接字符串的方法;
            function print(str) {
                // str = str.trim();
                html += str;
            }
            // console.log(res);
            console.log(eval(html));
            document.body.innerHTML = html;
        }

        // console.log(eval(html));
    var data = [{
            a: 5
        },
        {
            a: 4
        },
        {
            a: 3
        },
        {
            a: 2
        },
    ]
    var html = my_template(document.getElementById("template").innerHTML, data);
</script>

</html>