<!DOCTYPE html>
<html lang="en">
<head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta http-equiv="X-UA-Compatible" content="ie=edge">
      <title>Document</title>
      <style>
            .ball{
                  width: 20px;
                  height: 20px;
                  border-radius: 50%;
                  /* background: radial-gradient(#fff,#000); */
                  position: absolute;
                  
            }
      </style>
</head>
<body>
      <!-- <div class="ball">

      </div> -->
     <script>
           function Ball(selector){
                  this.timer = null;
                  this.mainEle = selector.nodeType === 9 ? selector : document.querySelector(selector);
                  this.cWitch  = document.documentElement.clientWidth;
                  this.cHeight = document.documentElement.clientHeight;
                  this.init();
           }
           //分工函数
           Ball.prototype.init = function(){
                  this.mainEle.addEventListener("mousedown" , this.handlerMouseDown.bind(this));
                  this.mainEle.addEventListener("mouseup" , this.handlerMouseUp.bind(this));
                  this.mainEle.addEventListener("mousemove",this.handlerMouseMove.bind(this));
           }
           //鼠标动起来
           Ball.prototype.handlerMouseMove = function(evt){
                  var e = evt || window.event;
                  this.offsetX = e.clientX;
                  this.offsetY = e.clientY;
           }
           //鼠标按下的事件
           Ball.prototype.handlerMouseDown = function(evt){
                  var e = evt || window.event;
                  this.offsetX = e.offsetX;
                  this.offsetY = e.offsetY;

                  clearInterval(this.timer);

                  this.timer = setInterval(function(){
                        //生球
                        var ball = this.createBall(this.offsetX,this.offsetY);
                        //球来了，但是不能再同一帧进行渲染，需要等一下
                        setTimeout(function(){
                              this.ballMove(ball,this.offsetX,this.offsetY)
                        }.bind(this),0)

                  }.bind(this),20)
                  // console.log(this.timer)
           }
           //让生成的球球动次打次
           Ball.prototype.ballMove = function(ball,offsetX,offsetY){
                  //创建随机位置
                  var randomWidth = Math.round(Math.random()*this.cWitch - offsetX);
                  var randomTop   = Math.round(Math.random()*this.cHeight -offsetY);

                  ball.style.left = randomWidth + "px";
                  ball.style.top  = randomTop + "px";
                  //逐渐美白
                  ball.style.opacity = 0.2;
                  //终是昙花一现
                  setTimeout(function(){
                        ball.remove();
                  },1000)
           }      
           //动态生成球球
           Ball.prototype.createBall = function(offsetX,offsetY){
                  var ball = document.createElement("div");
                  ball.className = "ball";

                  ball.style.left = offsetX + "px";
                  ball.style.top  = offsetY + "px";
                  ball.style.background = randomColor();
                  ball.style.transition = "all 1s";

                  this.mainEle.body.appendChild(ball);
                  return ball;
           }
           //终止球球的产出
           Ball.prototype.handlerMouseUp = function(){
            //      console.log(111);
                 clearInterval(this.timer);
           }
           //随机颜色
           function randomColor(){
                  var max = parseInt("ffffff",16);
                  var randomNum = max - Math.round(Math.random()*max);
                  var Color = "#"+randomNum.toString(16); 
                  // radial-gradient(#fff,#000)
                  return "radial-gradient("+ Color + ",#000)";
           }          
           new Ball(document);
      </script>
</body>
</html>