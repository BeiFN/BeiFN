<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>重力回弹运动</title>
    <style>
    #box{
        width: 600px;
        height: 500px;
        position: absolute;
        left: 0;
        right: 0;
        bottom: 0;
        top: 0;
        margin: auto;
        border: 1px solid #666666;
    }

    #ball{
        width: 40px;
        height:40px;
        border-radius: 50%;
        background:linear-gradient(orange,yellowgreen);
        position: absolute;
        top: 0;
        left: 50px;
    }
    #mask{
        width: 100%;
        height: 100%;
        position: absolute;
        left: 0;
        top: 0;
        z-index: 999;
    }
    #progress{
        width: 20px;
        height: 100px;
        overflow: hidden;  
        /* 控制progress的高度 */
        position: absolute;
        bottom: 0;
        left: 0;
        border-radius: 0px 2px 2px 0px;
    }
    #progress-bar{
        width: 20px;
        height: 100px;
        background:top linear-gradient(#f10,yellowgreen);
        border-radius: 0px 2px 2px 0px;
    }
    </style>
</head>
<body>
    <div id="container">
    <div id="box">
        <di id="mask"></di>
        <div id="ball">

        </div>
        <div id="progress">
            <div id="progress-bar"></div>
        </div>
    </div>
</div>
    <script>
    var container = document.getElementById("container");
    
     var oBall = document.getElementById("ball");
     var oProgress = document.getElementById("progress");
     var speedX =0;
     var g = 0.5;
    var moving =false;  //默认情况下不运动
     var speed =0;
     var timer = null;
     var target = 500;
     document.addEventListener("click",handlerClick);

     container.addEventListener("mousemove",handlerMouseMove);
    //  鼠标移动事件
     function handlerMouseMove(evt){
             var e = evt || window.event;
    //    获取小球位置

    if(!moving){   // 没有开始运动的时候，鼠标跟着小球运动
             oBall.style.left = e.offsetX -20 + "px";
             oBall.style.top = e.offsetY -20 + "px";
}
     getBallTurn(e.offsetX);   
     }
     function getBallTurn(x){  //x什么时候向左向右
         if(x<=300){
            //  console.log("向左");
            var prop = (300 - x) /300 *100;   //中间点300
             //300起始点  比例    正比
             speedX = -5*(prop/100);//向左走
         }else{
            //  console.log("向右");
            //  console.log(x-300);
            var prop = (x-300)/300*100;//成正比  总共300
            speedX = 5*(prop/100);   //向右走
         }
   
   oProgress.style.height = prop + "px";
     }
     
     function handlerClick(){
        //  console.log(132456)
         moving = true;//鼠标点击之后，鼠标了不再跟着球运动
         clearInterval(timer);
        timer = setInterval(ballMove,50);

     }
     function ballMove(){
         speed +=g;
         oBall.style.top = oBall.offsetTop + speed + "px";
         oBall.style.left = oBall.offsetLeft + speedX + "px";

         if(Math.abs(target-oBall.offsetTop  -40)<=speed){ 
             oBall.style.top =  target -40 +"px"; 
             speed  = -speed;
             if(speed>-2){
                 clearInterval(timer);
                 oBall.style.top = target - 40 +"px";
                 
             }
         }
                      
     }
   
  
    </script>
</body>
</html>