<!DOCTYPE html>
<html lang="en">
<head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta http-equiv="X-UA-Compatible" content="ie=edge">
      <title>Document</title>
      <link rel="stylesheet" href="https://cdn.bootcss.com/Swiper/4.5.0/css/swiper.min.css">
      <style>
            *{
                  margin: 0;
                  padding: 0;
            }
            html, body{
                  width: 100%;
                  height: 100%;
            }
      </style>
</head>
<body>
      <input type="text">
      <div></div>
      <script>
            //利用jsonp实现百度搜索
            function jsonp(url, cb_filed, data){
		return new Promise(function(resolve, reject){
				let GLOBAL = "foo";
				window[GLOBAL] = function(res){
					resolve(res);
                        }
                        // url += (/\?/.test(url) ? "&" : "?")+ cb_filed + "=" + GLOBAL;
                        // url += (/\?/.test(url))? "&" : "?" + cb_filed + "=" + GLOBAL;
                        // url += `"${cb_filed}" = "${GLOBAL}`;

                        // 判定是否存在数据;数据拼接;
                        // var dataStr = "";
                        // for(var attr in data){
                        //       dataStr += (dataStr.length > 0 ? "&" : "") + attr + "=" + data[attr];
                        // }
                        // url += "&" + dataStr;


				url += /\?/.test(url)? "&" : "?";
				url += `${cb_filed} \"=\" ${GLOBAL}`;
				for(let attr in data){
					url += `&${attr}\"=\"${data[attr]}`;
				}
				let script = document.createElement("script");
				script.src = url;
				script.onload = function(){
					this.remove();
				}
				document.body.appendChild(script);
			});
            }
            //jsonp实现百度搜索的步骤：
            // 1.获取到后端服务器发送的链接，传入到jsonp函数中的url中
            // 2.获取到不同的关键字,通过关键字从获取到后台相关的数据并且添加到页面上

            //获取baidu后台的url
            var url = "https://sp0.baidu.com/5a1Fazu8AA54nxGko9WTAnF6hhy/su";

            var data = {
                  json:1 ,
                  p:3,
                  // sid:1423_21080_29238_28518_29099_28830_29221_22158,
                  req:2,
                  sc:"eb",
                  csor:0,
                  _:Date.now(),
                  wd : "",
            }

            var input = document.querySelector("input");
            var div = document.querySelector("div");

            input.oninput = function(){
                  data.wd = this.value;
                  jsonp( url , "cb" , data)
                  .then( function (res){
                        var html = "";
                        res.s.forEach( item => html += `<p>${item}</p>`);
                        div.innerHTML = html;
                  })
            }
      </script>
</body>
</html>