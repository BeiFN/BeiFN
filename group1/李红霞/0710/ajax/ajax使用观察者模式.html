<!DOCTYPE html>
<html lang="en">
<head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta http-equiv="X-UA-Compatible" content="ie=edge">
      <title>Document</title>
</head>
<body>
      <script>
            // ajax使用观察者模式调用形式应该为： 其中ajax函数为发布者，其余的函数为订阅者
            // ajax.add(
            //       function(res){
            //             console.log(res)
            //       }
            // )
            function ajax(){
                  var list = [];
                  var xhr = new XMLHttpRequest();
                  xhr.open("GET", "http://localhost/ajax/ajax.txt");
                  xhr.send(null);
                  xhr.onreadystatechange = function(){
                        if(xhr.readyState == 4 && xhr.status == 200){
                              //如果接收到服务器返回到请求的数据，就调用订阅者的接受函数，提醒订阅者返回完成
                              //遍历调用订阅者的方法
                              for(attr in list){
                                    typeof list[attr] == "function"? list[attr](xhr.responseText):"";
                              }
                        }
                  }
                  return {
                        add: function(obj){
                              list.push(obj);
                        }
                  }
            }
            function observer(res){
                  console.log(res);
            }
            function observer1(res){
                  console.log(res);
            }
            ajax().add(observer);
            ajax().add(observer1);
            
      </script>
</body>
</html>