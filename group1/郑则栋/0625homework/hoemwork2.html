<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>委托封装</title>
		<style type="text/css">
			* {
				padding: 0;
				margin: 0;
			}

			li {
				list-style: none;
			}

			#ul1 li {
				width: 100px;
				text-align: center;
			}

			.color_red {
				background: red;
			}
		</style>
	</head>
	<body>
		<ul id="ul1">
			<li class="li">i am li</li>
			<li>i am li</li>
			<li>i am li</li>
			<li>i am li</li>
			<li>i am li</li>
			<li>i am li</li>
			<li>i am li</li>
			<li>i am li</li>
			<li>i am li</li>
			<li>
				<p>i am li</p>
			</li>
			<li>i am li111</li>
		</ul>
		<script type="text/javascript">
			var oul1 = document.getElementById("ul1");
			oul1.addEventListener("click", delegation(fn, ".li"));

			function delegation(fn, selector) {
				return function(eve) {
					"use strict";
					var e = eve || window.event;
					var myEle = document.querySelectorAll(selector);
					var target = e.target || e.srcElement;
					var temp_target = target;
					var target_family = [];
					while (true) {
						if (temp_target === this) {
							break;
						}
						target_family.push(temp_target);
						temp_target = temp_target.parentNode;
					}
					console.log(target_family);
					for(var i=0,ele;ele=myEle[i++];){
						if(target_family.indexOf(ele)!==-1){
							fn.call(ele,e);
							
						}
					}


				}
			}

			function fn() {
				// this.className+=" color_red";
				this.style.background="red";
				console.log(1)
			}
		</script>


	</body>
</html>
