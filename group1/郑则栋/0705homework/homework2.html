<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style type="text/css">
        * {
            margin: 0;
            padding: 0;
        }

        #bigbox {
            width: 500px;
            height: 500px;
            background: black;
            border: deeppink 2px solid;
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            margin: auto;
        }

        .smallBox {
            width: 7px;
            height: 7px;
            border-radius: 50%;
            position: absolute;
            z-index: 2;
        }

        .smallsmallBox {
            width: 3px;
            height: 3px;
            border-radius: 50%;
            position: absolute;
        }
    </style>
    <script src="javascript/public.js"></script>
</head>

<body>
    <div id="bigbox">

    </div>
    <script>
        class Firework {
            constructor({ele="big1box"}={}) {
                this.obigbox = document.getElementById(ele);
                this.init();
            }
            init() {
                this.obigbox.addEventListener("click", this.createFirework.bind(this));
            }
            createFirework(eve){
                let e = eve || window.event;
				let x = e.offsetX;
				let y = e.offsetY;
				let rgb = this.randomColor();
				this.createFireworks(x, y, rgb,this.fireBoom.bind(this,x,y));
            }
            createFireworks(x,y,rgb,boom,remove1){
                let smallFire = document.createElement("div");
				smallFire.className = "smallBox";
				smallFire.style.background = rgb;
				this.obigbox.appendChild(smallFire);
				smallFire.style.bottom = 0;
				smallFire.style.left = x + "px";
				move(smallFire, {
					top: y,
					opacity:50
				},function(){
					smallFire.remove();
					boom();
				});
            }
            fireBoom(x,y){
                var num = 15 + parseInt(Math.random() * 10);
				
				var r = 50 + parseInt(Math.random() * 100);

				for (var i = 0; i <= num; i++) {
				var rgb=this.randomColor();
					let smallsmallBox=document.createElement("div");
					smallsmallBox.className="smallsmallBox";
					smallsmallBox.style.background=rgb;
					let angle = parseInt(360 / num)*i;
					let cosx = Math.round(Math.cos(Math.PI / 180 * angle) * r+x);
					let siny = Math.round(Math.sin(Math.PI / 180 * angle) * r+y);
					smallsmallBox.style.left=x+"px";
					smallsmallBox.style.top=y+"px";
					this.obigbox.appendChild(smallsmallBox);
					move(smallsmallBox,{
						left:cosx,
						top:siny
					},function(cosx,siny,smallsmallBox){
						// this.fireBoom(cosx,siny);
						smallsmallBox.remove();
					}.bind(this,cosx,siny,smallsmallBox));
				}
            }
            randomColor(){
                let r = parseInt(Math.random() * 256);
				let g = parseInt(Math.random() * 256);
				let b = parseInt(Math.random() * 256);
				let rgb = "rgb(" + r + "," + g + "," + b + ")";
				return rgb;
            }



        }



        new Firework({ele:"bigbox"});

    </script>
</body>

</html>