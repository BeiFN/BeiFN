<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>观察者模式2</title>
</head>
<body>


    <script>
        class Observer{
            constructor(name,age){
                this.name=name;
                this.age=age;
            }
            accept(message){
                console.log(`我是练习时长${this.age}的${this.name},我喜欢${message} `)
            }

        }
        class Publisher{
            constructor(){
                this.list={
                    12:[],
                    18:[],
                    all:[]
                }
            }
            publish(age,message){
                let _temp='all';
                if(age>12&&age>18){
                    _temp=12;
                }
                else if(age>18){
                    _temp=18;
                }
                
                this.list[_temp].forEach(element => {
                    if(_temp==='all'){
                        element.accept(message);
                    }
                    else{
                        element.accept(message);
                        this.list[all].forEach(element=>{
                            element.accept(message);
                        });
                    }
                    
                });
                    
              
            }
            subscribe(age,obs){
                if(age>12&&age<18){
                        this.list[12].push(obs);
                    }
                    if(age>=18){
                        this.list[18].push(obs);
                    }
                    this.list['all'].push(obs);
            }
        }
        let obs1=new Observer('cxk',18);
        let obs2=new Observer('smflower',25);
        let obs3=new Observer('flower',22);
        let obs4=new Observer('rat',22);
        let pub=new Publisher();
        pub.subscribe(18,obs1);
        pub.subscribe(25,obs2);
        pub.subscribe(22,obs3);
        pub.subscribe(22,obs4);

        
        
        </script>



</body>
</html>